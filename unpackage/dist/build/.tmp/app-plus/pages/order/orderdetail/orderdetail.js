(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/orderdetail/orderdetail"],{"31b5":function(e,t,r){"use strict";r.r(t);var a=r("bf70"),o=r.n(a);for(var n in a)"default"!==n&&function(e){r.d(t,e,function(){return a[e]})}(n);t["default"]=o.a},"5ff4":function(e,t,r){"use strict";(function(e){r("ee7a"),r("921b");a(r("66fd"));var t=a(r("b756"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("6e42")["createPage"])},"6cc4":function(e,t,r){"use strict";var a=r("c48e"),o=r.n(a);o.a},"7c2e":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},o=[];r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o})},b756:function(e,t,r){"use strict";r.r(t);var a=r("7c2e"),o=r("31b5");for(var n in o)"default"!==n&&function(e){r.d(t,e,function(){return o[e]})}(n);r("6cc4");var d=r("2877"),s=Object(d["a"])(o["default"],a["a"],a["b"],!1,null,null,null);t["default"]=s.exports},bf70:function(e,t,r){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=getApp().globalData.weburl,o=(wx.getStorageSync("username")&&wx.getStorageSync("username"),wx.getStorageSync("token")?wx.getStorageSync("token"):"1"),n=(wx.getStorageSync("openid")&&wx.getStorageSync("openid"),wx.getStorageSync("userInfo")&&wx.getStorageSync("userInfo"),getApp().globalData.shop_type),d={data:function(){return{title_name:"记录详情",title_logo:"/static/images/footer-icon-05.png",delivery_background:a+"/uploads/line.png",share_title:"我的礼物详情单",share_desc:"送礼就是送心",orders:[],order_no:"",sendtime:"",orderprice:0,orderaddress:"",fullname:"",deliverycode:"",deliveryname:"",deliverystepinfo:"",deliveryinfo:[],delivery_status:[],deliveryflag:0,tel:"",rcvtime:"",page:1,pagesize:10,status:0,order_id:0,sku_num:0,giftflag:0,shop_type:n,scrollTop:1e3,currentPages_length:2,activeIndex2:"",tab2:"",winHeight:"",winWidth:"",wx_notes:"",gift_status:"",send_rcv:"",order_status:"",order_shape:"",buy_num:"",from_nickname:"",from_headimg:"",card_name_info:"",card_love_info:"",card_cele_info:"",card_register_info:"",card_type:"",userInfo:""}},components:{},props:{},onLoad:function(t){var r=this,a=r.orders,o=t.order_id?t.order_id:0,n=t.order_no?t.order_no:0,d=t.card_type?t.card_type:0,s=t.giftflag?t.giftflag:0,i=t.send_rcv?t.send_rcv:0,c=t.wx_notes?t.wx_notes:0,l=t.order_object?JSON.parse(t.order_object):"";wx.getSystemInfo({success:function(e){var t=e.windowHeight,a=e.windowWidth;r.setData({winHeight:t,winWidth:a})}});var u=getCurrentPages();if(r.setData({currentPages_length:u.length,wx_notes:c}),console.log(e("orderdetail onload options:",t,"order_object:",l,"length:",l.length," at pages\\order\\orderdetail\\orderdetail.vue:257")),l){console.log(e("订单详情",l," at pages\\order\\orderdetail\\orderdetail.vue:260"));var g=0,_=l["status"],f=l["gift_status"],p=(n=l["order_no"],l["shape"]),m=l["paytime"],v=l["rcvtime"],w=l["order_price"],y=l["address"],h=l["full_name"],S=l["from_nickname"],x=l["from_headimg"],k=l["tel"],T=l["deliverycode"],b=l["deliveryname"],I=l["deliverystepinfo"],D=l["status"],j=l["buy_num"],q=l["card_name_info"]?l["card_name_info"]:"",C=l["card_cele_info"]?l["card_cele_info"]:"",O=l["card_love_info"]?l["card_love_info"]:"",P=l["card_register_info"]?l["card_register_info"]:"";g=l["order_sku"]?l["order_sku"].length:1,a.push(l),r.setData({order_id:o||0,orders:a,status:_,giftflag:s||0,gift_status:f,send_rcv:i||0,order_status:D,order_shape:p,sku_num:g,buy_num:j,order_no:n,sendtime:m,rcvtime:v,orderprice:w,orderaddress:y||"",tel:k||"",fullname:h||"",from_nickname:S,from_headimg:x,deliverycode:T||"",deliveryname:b||"",deliverystepinfo:I||"",card_name_info:q,card_love_info:O,card_cele_info:C,card_register_info:P,card_type:d})}else n||o?(r.setData({order_no:n,order_id:o}),r.reloadData()):wx.navigateBack()},onShow:function(){var e=this,t=getCurrentPages();t.length>1&&e.setData({title_logo:"../../../images/back.png"})},onShareAppMessage:function(){var e=this,t=wx.getStorageSync("username")?wx.getStorageSync("username"):"",r=e.order_no;return{title:e.share_title,desc:e.share_desc,path:"/pages/order/orderdetail/orderdetail?order_no="+r+"&refername="+t}},methods:{pageScrollToBottom:function(){wx.createSelectorQuery().select("#j_page").boundingClientRect(function(e){wx.pageScrollTo({scrollTop:450})}).exec()},formSubmit:function(t){var r=this,a=t.detail.formId,o=t.currentTarget.dataset.name,n=r.order_shape;console.log(e("formSubmit() formID：",a," form name:",o," at pages\\order\\orderdetail\\orderdetail.vue:359")),"express"==o?r.expressTapTag():"navigateToCustomerService"==o?r.navigateToCustomerService():"goBack"==o&&(5==n?wx.navigateTo({url:"/pages/list/list?navlist_title=贺卡请柬"}):4==n?wx.navigateTo({url:"/pages/list/list?navlist_title=互动卡"}):r.goBack()),a&&r.submintFromId(a)},submintFromId:function(t){var r=this,o=(t=t,r.shop_type),n=wx.getStorageSync("username")?wx.getStorageSync("username"):"",d=wx.getStorageSync("token")?wx.getStorageSync("token"):"1";wx.request({url:a+"/api/client/save_member_formid",method:"POST",data:{username:n,access_token:d,formId:t,shop_type:o},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(t){console.log(e("submintFromId() update success: ",t.data," at pages\\order\\orderdetail\\orderdetail.vue:402"))}})},goBack:function(){var e=getCurrentPages();e.length>1?wx.navigateBack({changed:!0}):wx.switchTab({url:"../../hall/hall"})},onTapTag2:function(e){var t=this,r=e.currentTarget.id,a=e.currentTarget.dataset.index;t.setData({activeIndex2:a,tab2:r,page:1})},expressTapTag:function(){var t=this,r=t.shop_type,o=t.order_no,n=wx.getStorageSync("username")?wx.getStorageSync("username"):"",d=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",s=t.deliveryflag;console.log(e("物流详情:"+o+" "+n+" "+d," at pages\\order\\orderdetail\\orderdetail.vue:436")),1!=s&&wx.request({url:a+"/api/client/query_delivery_info",method:"POST",data:{username:n,access_token:d,order_no:o,shop_type:r},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(r){if(console.log(e(r.data," at pages\\order\\orderdetail\\orderdetail.vue:453")),r.data.result){r.data.result["status_list"].length<2&&(wx.showToast({title:"暂无轨迹信息",icon:"loading",duration:1500}),setTimeout(function(){},500));var a=r.data.result,o=a["status_list"],n=t.delivery_status;if(o)for(var d=o.length-1,s=0;s<o.length;s++)n[d-s]=o[s];t.setData({deliveryinfo:a,delivery_status:n,deliveryflag:1}),t.pageScrollToBottom()}else wx.showToast({title:"暂无物流信息",icon:"loading",duration:1500}),setTimeout(function(){},500)}})},reloadData:function(){var t=this,r=wx.getStorageSync("username")?wx.getStorageSync("username"):"",o=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",n=wx.getStorageSync("m_id")?wx.getStorageSync("m_id"):"0",d=t.status,s=t.shop_type,i=t.order_no,c=t.order_id;console.log(e("orderdetail reloadData() 从服务器获取订单 order_no: ",i," at pages\\order\\orderdetail\\orderdetail.vue:506")),i?wx.request({url:a+"/api/client/query_order",method:"POST",data:{username:r,access_token:o,status:d,shop_type:s,order_no:i,order_id:c},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(r){console.log(e("orderdetail query order:",r.data.result," at pages\\order\\orderdetail\\orderdetail.vue:525"));var o=r.data.result;r.data.all_rows;if(r.data.result){for(var d=0;d<o.length;d++){o[d]["logo"].indexOf("http")<0&&(o[d]["logo"]=a+"/"+o[d]["logo"]);for(var s=0;s<o[d]["order_sku"].length;s++)if(o[d]["order_sku"][s]["sku_image"].indexOf("http")<0&&(o[d]["order_sku"][s]["sku_image"]=a+o[d]["order_sku"][s]["sku_image"]),o[d]["order_sku"][s]["sku_value"])for(var i=0;i<o[d]["order_sku"][s]["sku_value"].length;i++);}console.log(e("orderdetail reloadData() orderObjects:",o," at pages\\order\\orderdetail\\orderdetail.vue:557"));var c=o[0]["status"],l=o[0]["gift_status"],u=o[0]["id"],g=o[0]["order_no"],_=o[0]["paytime"],f=o[0]["rcvtime"],p=o[0]["order_price"],m=o[0]["address"],v=o[0]["full_name"],w=o[0]["from_nickname"],y=o[0]["from_headimg"],h=o[0]["tel"],S=o[0]["deliverycode"],x=o[0]["deliveryname"],k=o[0]["deliverystepinfo"],T=(o[0]["status"],o[0]["buy_num"]),b=o[0]["order_sku"][0]["sku_num"],I=o[0]["m_id"]==n?0:1,D=0==I?"send":"receive",j=o[0]["shape"]?o[0]["shape"]:1;t.setData({orders:o,buy_num:T,sku_num:b,order_id:u||0,status:c,giftflag:I||0,gift_status:l,send_rcv:D,order_status:c,order_no:g,sendtime:_,rcvtime:f,orderprice:p,orderaddress:m,tel:h,order_shape:j,fullname:v,from_nickname:w,from_headimg:y,deliverycode:S||"",deliveryname:x||"",deliverystepinfo:k||""})}else wx.showToast({title:"暂无",icon:"loading",duration:1500}),setTimeout(function(){wx.navigateBack()},500)}}):(wx.showToast({title:"订单不存在",icon:"loading",duration:1500}),setTimeout(function(){wx.navigateBack()},1500))},pay:function(t){var r=t.currentTarget.dataset.objectId,a=t.currentTarget.dataset.totalFee,o=t.currentTarget.dataset.received?t.currentTarget.dataset.received:0;console.log(e("orderdetail pay() order_no:",r,"received:",o," at pages\\order\\orderdetail\\orderdetail.vue:621")),wx.navigateTo({url:"../payment/payment?orderNo="+r+"&totalFee="+a+"&received="+o})},receive:function(t){var r=wx.getStorageSync("username")?wx.getStorageSync("username"):"",o=wx.getStorageSync("token")?wx.getStorageSync("token"):"1";wx.showModal({title:"请确认",content:"确认要收货吗",success:function(n){if(n.confirm){var d=t.currentTarget.dataset.objectId;wx.request({url:a+"/api/client/order_confirm",method:"POST",data:{username:r,access_token:o,id:d},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(t){console.log(e(t.data.result," at pages\\order\\orderdetail\\orderdetail.vue:650")),console.log(e(t.data.info," at pages\\order\\orderdetail\\orderdetail.vue:651")),t.data.info?wx.showToast({title:t.data.info,icon:"loading",duration:1500}):wx.showToast({title:"确认收货完成",icon:"success",duration:1e3})}})}}})},showGoods:function(t){var r=this,a=t.currentTarget.dataset.skuId,o=wx.getStorageSync("username")?wx.getStorageSync("username"):"",n=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",d=t.currentTarget.dataset.goodsId,s=t.currentTarget.dataset.goodsName,i=(t.currentTarget.dataset.goodsShape,r.order_no),c=r.order_id,l=t.currentTarget.dataset.orderShape,u=r.card_type,g=r.send_rcv;console.log(e("orderdetail showGoods() 查看详情 order_no: ",i," order_id:",c," order_shape:",l," receive:",g," at pages\\order\\orderdetail\\orderdetail.vue:685")),5==l||4==l?wx.navigateTo({url:"/pages/order/receive/receive?order_no="+i+"&order_id="+c+"&order_shape="+l+"&card_type="+u+"&receive="+g}):wx.navigateTo({url:"../../details/details?sku_id="+a+"&goods_name="+s+"&id="+d+"&token="+n+"&username="+o})},showinteracton:function(e){var t=this,r=(wx.getStorageSync("username")&&wx.getStorageSync("username"),wx.getStorageSync("token")&&wx.getStorageSync("token"),e.currentTarget.dataset.orderId),a=e.currentTarget.dataset.orderShape,o=t.send_rcv;4!=a&&5!=a||wx.navigateTo({url:"/pages/order/list/list?order_id="+r+"&order_shape="+a+"&receive="+o})},navigateToCustomerService:function(){var t=r.getStorageSync("username")?r.getStorageSync("username"):"",d="http://wpa.qq.com/msgrd?v=3&uin=198895160&site=qq&menu=yes",s=this.order_no,i=this.order_id;r.request({url:a+"/api/client/query_webview_url",method:"POST",data:{username:t,access_token:o,shop_type:n,order_no:s,order_id:i,webview_type:"1"},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(t){if(console.log(e("web view url：",t.data.result," at pages\\order\\orderdetail\\orderdetail.vue:732")),"y"==t.data.status){var r=t.data.result;d=r.url,plus.runtime.openURL(d,function(e){plus.nativeUI.alert("本机没有安装QQ，无法启动")})}else wx.showToast({title:"暂时没有WEBVIEW URL",icon:"none",duration:1500})}})},setData:function(e){var t,r,a=this,o=[];Object.keys(e).forEach(function(n){o=n.split("."),t=e[n],r=a.$data,o.forEach(function(e,n){n+1==o.length?a.$set(r,e,t):r[e]||a.$set(r,e,{}),r=r[e]})})}}};t.default=d}).call(this,r("0de9")["default"],r("6e42")["default"])},c48e:function(e,t,r){}},[["5ff4","common/runtime","common/vendor"]]]);