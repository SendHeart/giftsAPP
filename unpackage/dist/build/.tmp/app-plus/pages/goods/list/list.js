(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/list/list"],{"5b1f":function(e,t,a){"use strict";a.r(t);var o=a("7643"),n=a.n(o);for(var s in o)"default"!==s&&function(e){a.d(t,e,function(){return o[e]})}(s);t["default"]=n.a},7643:function(e,t,a){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;a("3936");var n=function(){return Promise.all([a.e("common/vendor"),a.e("components/mescroll-diy/mescroll-beibei")]).then(a.bind(null,"eaef"))},s=function(){return a.e("pages/goods/list/pd-list").then(a.bind(null,"9909"))},i=getApp().globalData.weburl,l=getApp().globalData.shop_type,r=[{id:"default",title:"最新"},{id:"hot",title:"人气"},{id:"price",title:"价格"}],g={data:function(){return{title_name:"搜索礼物",title_logo:"/static/images/footer-icon-05.png",img_discount:"/static/images/discount.png",default_img:i+"/uploads/default_goods_image.png",activeIndex:0,activeIndex2:0,navList2:r,images:[],all_rows:1,venuesItems:[],hidddensearch:!0,search_goodsname:null,keyword:"",satisfy:!0,is_satiify:0,page:1,pagesize:20,pageoffset:0,indicatorDots:!0,vertical:!1,autoplay:!0,interval:3e3,duration:1e3,loadingHidden:!0,is_loading:!1,msgList:[],hidden:!0,scrollTop:0,old:{scrollTop:0},scrollHeight:0,tab:"is_recommend",tab_value:"1",tab2:"default",updown:0,shop_type:l,scrollLeft:0,toView:0,inputShowed:!0,is_satisfy:"",floorstatus:!1,loading_note:"",username:"",token:"",navlist_toView:"",goods_type:"",goods_type_value:"",userInfo:"",platform:"",windowHeight:"",windowWidth:"",dkheight:"",navList:"",index:"",status:"more",contentText:{contentdown:"上拉加载更多",contentrefresh:"加载中",contentnomore:"没有更多"},downOption:{auto:!1,use:!1,isLock:!0},upOption:{auto:!1,onScroll:!0,page:{num:0,size:20},noMoreSize:4,empty:{tip:"~ 空空如也 ~",btnText:"去看看"}},pdList:[],isInit:!1,scrollY:0}},components:{MescrollUni:n,PdList:s},props:{},onLoad:function(e){var t=this,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",o=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",n=e.middle_title?e.middle_title:"特色礼物",s=e.navlist?e.navlist:0,i=e.goods_type_value?e.goods_type_value:0,l="goods_middle_search",r=1!=e.search;n=1==e.search?"搜索礼物":n,wx.setNavigationBarTitle({title:n}),t.setData({username:a,token:o,navlist_toView:s,goods_type:l,goods_type_value:i,hidddensearch:r}),wx.getSystemInfo({success:function(e){t.setData({platform:e.platform,windowHeight:e.windowHeight,windowWidth:e.windowWidth,dkheight:e.windowHeight-10})}})},onShow:function(){var e=this,t=getCurrentPages();t.length>1&&e.setData({title_logo:"/images/back.png"})},onShareAppMessage:function(){return{title:"送心礼物",desc:"开启礼物电商时代，200万人都在用的礼物小程序！",path:"/pages/list/list?refername="+username}},mounted:function(){this.isInit=!0,this.mescroll.triggerDownScroll()},methods:{load:function(){var t=this;e.createSelectorQuery().selectAll(".lazy").boundingClientRect(function(e){e.forEach(function(e,a){e.top<=t.windowHeight&&(t.venuesItems[e.dataset.index].show=!0)})}).exec()},imageLoad:function(e){this.venuesItems[e.target.dataset.index].loaded=!0},satisfyTagTap:function(e){var t=this,a=e.currentTarget.dataset.satisfy;t.setData({satisfy:a,is_satisfy:a?1:2})},goBack:function(){var e=getCurrentPages();e.length>1?wx.navigateBack({changed:!0}):wx.switchTab({url:"../hall/hall"})},swiperchange:function(e){},onTapTag:function(e){var t=this,a=e.currentTarget.dataset.id,o=e.currentTarget.dataset.value,n=e.currentTarget.dataset.index,s=e.currentTarget.dataset.title,i=t.navList,l=n;l=n>2&&n<i.length?n-2:0,"search_goodsname"!=a&&(s=""),t.setData({activeIndex:n,tab:a,tab_value:o,page:1,search_goodsname:s,toView:l||0}),t.goTop()},onTapTag2:function(e){var t=this,a=(e.currentTarget.id,e.currentTarget.dataset.tabid),o=e.currentTarget.dataset.index,n=1==t.updown?0:1;t.activeIndex2=o,t.tab2=a,t.page=1,t.updown=n,t.venuesItems_show=[],t.venuesItems=[],t.goTop()},scroll:function(e){var t=this,a=(t.old.scrollTop,t.mescroll.scrollTop);t.old.scrollTop=a},goTop:function(e){var t=this;wx.getStorageSync("navList2")&&wx.getStorageSync("navList2");t.pdList=[],t.page=1,t.pageoffset=0,t.mescroll.resetUpScroll(),getApp().globalData.hall_gotop=0,t.$nextTick(function(){t.mescroll.scrollTo(0)}),t.mescroll.scrollTop=t.old.scrollTop},searchTapTag:function(e){var t=this;t.goTop()},getMoreGoodsTapTag:function(e){var t=this,a=t.page+1,o=t.all_rows,n=t.is_loading;n||(a>o?t.status="nomore":(t.page=a,t.get_goods_list()))},search_goodsnameTapTag:function(e){var t=this,a=e.detail.value;t.setData({keyword:a})},showGoods:function(t){var a=t.id,o=wx.getStorageSync("username")?wx.getStorageSync("username"):"",n=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",s=t.goods_id?t.goods_id:t.id,i=t.goods_org,l=t.shape,r=t.name,g=t.sell_price,c=t.atc_info,d=t.sale,u=t.image?t.image:"",p=t.activity_image?t.activity_image:"";u=u||(p||""),getApp().globalData.hall_gotop=0;var f={sku_id:a,id:s,goods_shape:l,goods_org:i,goods_info:c,goods_price:g,sale:d,name:r,image:u,token:n,username:o};e.setStorageSync("show_goods_options",f),setTimeout(function(){wx.navigateTo({url:"/pages/details/details?sku_id="+a+"&id="+s+"&goods_shape="+l+"&goods_org="+i+"&goods_info="+c+"&goods_price="+g+"&sale="+d+"&name="+r+"&image="+u+"&token="+n+"&username="+o})},100)},gotoAITagTap:function(e){getApp().globalData.messageflag=2,wx.switchTab({url:"/pages/member/message/message"})},mescrollInit:function(e){this.mescroll=e},downCallback:function(e){this.page=1,e.resetUpScroll()},upCallback:function(e){var t=this;this.getListDataFromNet(e.num,e.size,function(a){console.log(o("i="+t.i+", mescroll.num="+e.num+", mescroll.size="+e.size+", curPageData.length="+a.length," at pages\\goods\\list\\list.vue:454")),e.endSuccess(a.length),1!=e.num&&1!=t.page||(t.pdList=[]),"n"==a?e.endByPage(t.page,t.all_rows):t.pdList=t.pdList.concat(a)},function(){e.endErr()})},emptyClick:function(){e.showToast({title:"点击了按钮,具体逻辑自行实现"})},getListDataFromNet:function(e,t,a,n){var s=this,l=s.page,r=s.pagesize,g=s.pageoffset,c=wx.getStorageSync("username")?wx.getStorageSync("username"):"",d=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",u=s.goods_type,p=s.goods_type_value,f=s.tab2,m=s.updown,_=s.search_goodsname,h=s.keyword,v=s.shop_type,w=1,y=s.all_rows;if(l>y&&l>1)return console.log(o("加载完成 page:",l,"all_rows:",y," at pages\\goods\\list\\list.vue:497")),s.is_goodslist_loading=!1,void(a&&a("n"));s.is_goodslist_loading=!0,s.status="loading";try{wx.request({url:i+"/api/client/get_goods_list",method:"POST",data:{goods_type:u,goods_type_value:p,username:c,access_token:d,page:l,pagesize:r,pageoffset:g,search_goodsname:_,goods_sales:f,updown:m,keyword:h,shop_type:v,shape:w},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){var t=e.data.result,n=e.data.all_rows,r=e.data.pageoffset;if(!t)return s.is_goodslist_loading=!1,void(a&&a(e.data.status));if(t){for(var g=0;g<t.length;g++)t[g]["short_name"]=t[g]["name"].substring(0,10)+"...",t[g]["act_info"]||(t[g]["act_info"]=""),t[g]["goods_tag"]?t[g]["goods_tag"]=t[g]["goods_tag"].substring(0,10):t[g]["goods_tag"]="",t[g]["activity_image"].indexOf("http")<0&&t[g]["activity_image"]&&(t[g]["activity_image"]=i+"/"+t[g]["activity_image"]),t[g]["image"].indexOf("http")<0&&t[g]["image"]&&(t[g]["image"]=i+"/"+t[g]["image"]),t[g]["image"]=t[g]["activity_image"]?t[g]["activity_image"]:t[g]["image"];s.page=l+1,s.pageoffset=r,s.all_rows=n,console.log(o("加载 page:",l,"all_rows:",n," venuesItems_new:",t," at pages\\goods\\list\\list.vue:567")),a&&a(t)}}})}catch(T){n&&n()}},get_menubar:function(e){var t=this,a=t.navlist_toView;wx.request({url:i+"/api/client/get_menubar",method:"POST",data:{menu_type:1},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){var o=e.data.result;o?(t.setData({navList:o,index:a,activeIndex:a,tab:o[a]["id"],tab_value:o[a]["value"]}),setTimeout(function(){t.setData({loadingHidden:!0})},1500)):wx.showToast({title:"没有菜单项",icon:"loading",duration:1500})}})},setData:function(e){var t,a,o=this,n=[];Object.keys(e).forEach(function(s){n=s.split("."),t=e[s],a=o.$data,n.forEach(function(e,s){s+1==n.length?o.$set(a,e,t):a[e]||o.$set(a,e,{}),a=a[e]})})}}};t.default=g}).call(this,a("6e42")["default"],a("0de9")["default"])},bc93:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},n=[];a.d(t,"a",function(){return o}),a.d(t,"b",function(){return n})},cee6:function(e,t,a){"use strict";a.r(t);var o=a("bc93"),n=a("5b1f");for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);a("e41b");var i=a("2877"),l=Object(i["a"])(n["default"],o["a"],o["b"],!1,null,null,null);t["default"]=l.exports},d177:function(e,t,a){"use strict";(function(e){a("ee7a"),a("921b");o(a("66fd"));var t=o(a("cee6"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("6e42")["createPage"])},e41b:function(e,t,a){"use strict";var o=a("f8d1"),n=a.n(o);n.a},f8d1:function(e,t,a){}},[["d177","common/runtime","common/vendor"]]]);