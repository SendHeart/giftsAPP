(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/index"],{"1f54":function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement;e._self._c},i=[];t.d(a,"a",function(){return n}),t.d(a,"b",function(){return i})},"54ec":function(e,a,t){"use strict";(function(e,n){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(t("a34a")),o=r(t("80dc"));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,a,t,n,i,o,r){try{var s=e[o](r),d=s.value}catch(c){return void t(c)}s.done?a(d):Promise.resolve(d).then(n,i)}function d(e){return function(){var a=this,t=arguments;return new Promise(function(n,i){var o=e.apply(a,t);function r(e){s(o,n,i,r,d,"next",e)}function d(e){s(o,n,i,r,d,"throw",e)}r(void 0)})}}var c=t("13aa"),l=function(){return Promise.all([t.e("common/vendor"),t.e("components/uParse/src/wxParse")]).then(t.bind(null,"dcb8"))},u=function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"dcc0"))},g=getApp().globalData.weburl,m=(getApp().globalData.appid,getApp().globalData.secret,getApp().globalData.user_type&&getApp().globalData.user_type,getApp().globalData.shop_type),_=e.getStorageSync("username")?e.getStorageSync("username"):"",p=e.getStorageSync("token")?e.getStorageSync("token"):"1",h=(e.getStorageSync("openid")&&e.getStorageSync("openid"),e.getStorageSync("m_id")&&e.getStorageSync("m_id"),e.getStorageSync("userInfo")?e.getStorageSync("userInfo"):""),f=e.getStorageSync("userauth")?e.getStorageSync("userauth"):{},y=e.getStorageSync("navList2")?e.getStorageSync("navList2"):[{}],w=getApp().globalData.uploadurl,v={data:function(){return{title_name:"我的",title_logo:"/static/images/footer-icon-05.png",share_art_image:g+"/uploads/share_art_image.jpg",nickname:h.nickname?h.nickname:"匿名",avatarUrl:h.avatarUrl,default_avatar:g+"/uploads/avatar.png",hideviewagreementinfo:!0,agreementinfoshowflag:0,playsxinfoshowflag:0,artinfoshowflag:0,scrollTop:0,scrollTop_init:10,modalHiddenCele:!0,modalHiddenAgreement:!0,modalHiddenBankcard:!0,modalHiddenPlaysx:!1,modalHiddenMember:!0,modalHiddenArt:!0,modalHiddenArtInfo:!0,modalHiddenPhone:!0,modalHiddenUserName:!0,modalHiddenScan:!1,modalName:null,hiddenNickname:!0,shop_type:m,index:0,art_index:0,web_url:"",web_id:"",image_save_count:0,needPhoneNumber:"微信授权",needUserName:"微信授权",login_button:"登录",inputShowed:!1,bank_name:"",bank_id:"",bankcard_no:"",bankcard_name:"",bank_info:"",user_name:"",user_gender:"",agreementInfo:"",playsxInfo:"",article:"",article_title:"",dkheight:"800",webviewurl:"",art_title:"",art_id:"",art_cat_id:"",art_image:"",navList2:"",hall_banner:"",middle1_img:"",middle2_img:"",middle3_img:"",middle4_img:"",middle1_title:"",middle2_title:"",middle3_title:"",middle4_title:"",middle1_note:"",middle2_note:"",middle3_note:"",middle4_note:"",loadingHidden:!1,refer_id:"",frompage:"",user_type:"",user_level:"",userauth:f,userInfo:h,userauth_coupon:0,userauth_shoper:0,userauth_celebration:0,userauth_location:0,userauth_article:0,new_img_arr:"",scan_result:""}},components:{uParse:l,uniPopup:u},props:{},onLoad:function(a){var t=this,i=(t.gifts_rcv,t.gifts_send,e.getStorageSync("openid")&&e.getStorageSync("openid"),e.getStorageSync("username")?e.getStorageSync("username"):""),o=(e.getStorageSync("m_id")&&e.getStorageSync("m_id"),e.getStorageSync("token")&&e.getStorageSync("token"),a.frompage?a.frompage:""),r=a.art_id?a.art_id:0,s=a.art_cat_id?a.art_cat_id:0,d=a.art_title?a.art_title:"",c=a.mid?a.mid:0,l=e.getStorageSync("userInfo"),u=e.getStorageSync("userauth")?e.getStorageSync("userauth"):"";t.login_button=i?"重新登录":"登录",t.get_project_gift_para(),t.userauth=u,t.userauth_coupon=u.coupon,t.userauth_shoper=u.shoper,t.userauth_celebration=u.celebration,t.userauth_article=u.article,t.userauth_location=u.location,t.nickname=l.nickname?l.nickname:"匿名",t.avatarUrl=l.avatarUrl?l.avatarUrl:"",t.frompage=o,t.art_id=r,t.art_cat_id=s,t.art_title=d,t.refer_id=c,console.log(n("my index onLoad() userauth:",u,"user_name:",t.user_name," at pages\\my\\index.vue:244"))},onShow:function(){var a=this,t=e.getStorageSync("username")?e.getStorageSync("username"):"",i=e.getStorageSync("user_type")?e.getStorageSync("user_type"):0,o=e.getStorageSync("user_phone")?e.getStorageSync("user_phone"):"",r=e.getStorageSync("user_name")?e.getStorageSync("user_name"):"",s=e.getStorageSync("user_level")?e.getStorageSync("user_level"):"",d=(a.modalHiddenPhone,a.modalHiddenUserName),c=e.getStorageSync("userInfo")?e.getStorageSync("userInfo"):"",l=e.getStorageSync("userauth")?e.getStorageSync("userauth"):"",u=e.getStorageSync("isReadAgreement")?e.getStorageSync("isReadAgreement"):0,g=e.getSystemInfoSync(),m=g.windowWidth,_=g.windowHeight;i=parseInt(i),console.log(n("my index onShow() user_phone:",o,"userauth:",l," at pages\\my\\index.vue:261")),r&&""!=r?0==u&&t&&a.navigateToAgreement():(d=!d,a.setData({modalHiddenUserName:d})),a.windowWidth=m,a.windowHeight=_,a.user_type=i,a.userInfo=c,a.nickname=c.nickname,a.avatarUrl=c.avatarUrl,a.userauth=l,a.userauth_coupon=l.coupon,a.userauth_shoper=l.shoper,a.userauth_celebration=l.celebration,a.userauth_article=l.article,a.userauth_location=l.location,a.user_level=s,console.log(n("my index userauth_coupon:",a.userauth_coupon," at pages\\my\\index.vue:291"))},onShareAppMessage:function(){var e=this,a=(wx.getStorageSync("username")&&wx.getStorageSync("username"),e.art_id),t=e.art_cat_id,n=e.art_image?e.art_image:e.share_art_image,i=e.art_title,o=e.m_id>0?e.m_id:0;e.art_id,e.art_cat_id;return{title:i,desc:i,imageUrl:n,path:"/pages/my/index?art_id="+a+"&art_cat_id="+t+"&image="+n+"&refer_id="+o}},methods:{scan:function(){var a=d(i.default.mark(function a(){var t,n=this;return i.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,this.checkPermission();case 2:if(t=a.sent,1===t){a.next=5;break}return a.abrupt("return");case 5:e.scanCode({success:function(e){var a=e.result;n.scan_result=a,a.indexOf("http")>-1?wx.navigateTo({url:"/pages/customerservice/customerservice?url="+a}):n.modalHiddenScan=!0},fail:function(e){}});case 6:case"end":return a.stop()}},a,this)}));function t(){return a.apply(this,arguments)}return t}(),checkPermission:function(){var a=d(i.default.mark(function a(t){var n;return i.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(!o.default.isIOS){a.next=6;break}return a.next=3,o.default.requestIOS("camera");case 3:a.t0=a.sent,a.next=9;break;case 6:return a.next=8,o.default.requestAndroid("android.permission.CAMERA");case 8:a.t0=a.sent;case 9:return n=a.t0,null===n||1===n?n=1:e.showModal({content:"需要相机权限",confirmText:"设置",success:function(e){e.confirm&&o.default.gotoAppSetting()}}),a.abrupt("return",n);case 12:case"end":return a.stop()}},a,this)}));function t(e){return a.apply(this,arguments)}return t}(),modalBindconfirmScan:function(e){var a=this;a.modalHiddenScan=!1,console.log(n("modalHiddenScan:"+a.modalHiddenScan," at pages\\my\\index.vue:375"))},goBack:function(){var a=this,t=getCurrentPages(),n=e.getStorageSync("userInfo"),i=a.frompage;n&&(t.length>1?i?wx.switchTab({url:i}):wx.navigateBack({changed:!0}):wx.switchTab({url:"../hall/hall"}))},bindPickerChange:function(e){var a=this,t=e.detail.value,i=a.bank_info[t]["bank_name"],o=a.bank_info[t]["id"];console.log(n("picker发送选择改变，携带值为",e.detail.value," at pages\\my\\index.vue:406")),a.setData({index:t,bank_name:i,bank_id:o}),console.log(n("自定义值:",a.bank_info[t]["bank_name"]," at pages\\my\\index.vue:412"))},bindchangeBankcardno:function(e){var a=this,t=e.detail.value;a.setData({bankcard_no:t}),console.log(n("bankcard_no:"+a.bankcard_no," at pages\\my\\index.vue:420"))},bindchangeBankcardname:function(e){var a=this,t=e.detail.value;a.setData({bankcard_name:t}),console.log(n("bankcard_name:"+a.bankcard_name," at pages\\my\\index.vue:428"))},get_bank_info:function(){var e=this,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",t=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",i=e.shop_type;wx.request({url:g+"/api/client/get_bankinfo",method:"POST",data:{username:a,access_token:t,shop_type:i},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(o){if("y"==o.data.status){var r=o.data.result,s=e.index;e.setData({bank_info:r,modalHiddenBankcard:!e.modalHiddenBankcard,bank_name:r[s]["bank_name"],bank_id:r[s]["id"]}),console.log(n("获取银行列表完成:",o.data.result," at pages\\my\\index.vue:459")),wx.request({url:g+"/api/client/get_member_bankcardinfo",method:"POST",data:{username:a,access_token:t,shop_type:i},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(a){if("y"==a.data.status){var t=a.data.result;if(e.setData({bank_name:t[0]["bank_name"],bank_id:t[0]["bank_id"],bankcard_no:t[0]["bank_cardno"],bankcard_name:t[0]["bank_cardname"]}),t[0]["id"])for(var i=0;i<e.bank_info.length;i++)e.bank_info[i]["id"]==t[0]["bank_id"]&&e.setData({index:i});console.log(n("获取我的银行列表完成:",a.data.result," at pages\\my\\index.vue:493"))}}})}else wx.showToast({title:o.data.info+"[失败]",icon:"none",duration:1500})}})},band_bank_card:function(){var e=this,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",t=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",i=e.shop_type,o=e.bank_id,r=e.bankcard_no,s=e.bankcard_name,d=new RegExp("[0-9]","g"),c=d.exec(r);c?wx.request({url:g+"/api/client/update_member_bankcardinfo",method:"POST",data:{username:a,access_token:t,shop_type:i,bank_id:o,bank_cardno:r,bank_cardname:s},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){"y"==e.data.status?(wx.showToast({title:"银行卡绑定成功",icon:"none",duration:1500}),console.log(n("银行卡绑定完"," at pages\\my\\index.vue:543"))):wx.showToast({title:e.data.info+"[失败]",icon:"none",duration:1500})}}):wx.showToast({title:"银行卡输入有误",icon:"loading",duration:1500})},onKeyUserNickNameInput:function(e){this.hiddenNickname;this.nickname=e.target.value},update_userinfo:function(){var a=this,t=wx.getStorageSync("username")?wx.getStorageSync("username"):"",i=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",o=a.avatarUrl?a.avatarUrl:"",r=a.nickname?a.nickname:"匿名",s=a.hiddenNickname;wx.request({url:g+"/api/client/update_name",method:"POST",data:{username:t,access_token:i,shop_type:m,headimgurl:o,wx_nickname:r},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(t){t.data.result;var i={nickname:r,avatarUrl:o};a.userInfo=i,e.setStorageSync("userInfo",i),a.hiddenNickname=!s,console.log(n("更新用户资料:",i," at pages\\my\\index.vue:597"))}})},getUserName:function(e,a){var t=wx.getStorageSync("username")?wx.getStorageSync("username"):"",n=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",i=wx.getStorageSync("openid")?wx.getStorageSync("openid"):"";e&&a&&wx.request({url:g+"/api/client/update_name",method:"POST",data:{username:t||i,access_token:n,full_name:e,sex:a,shop_type:m},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(a){(a.data.status="y")?wx.setStorageSync("user_name",e):wx.showToast({title:"姓名更新失败",icon:"none",duration:1e3})}})},user_nicknameTapTag:function(){var e=this,a=e.hiddenNickname;e.setData({hiddenNickname:!a})},user_nameTapTag:function(e){var a=this,t=e.detail.value;a.setData({user_name:t})},modalBindconfirmUsername:function(){var e=this,a=e.user_name,t=e.user_gender;if(a&&t)e.setData({modalHiddenUserName:!e.modalHiddenUserName}),e.getUserName(a,t);else{var n="需要您的姓名和性别";e.setData({needUserName:n})}},radiochange:function(e){var a=this,t=e.detail.value;a.setData({user_gender:t}),wx.setStorageSync("user_gender",t)},navigateToAgreement:function(){var e=this,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",t=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",i="21",o="9",r=e.shop_type,s=e.agreementinfoshowflag?e.agreementinfoshowflag:0;0==s?(wx.showToast({title:"加载中",icon:"loading",duration:1500}),wx.request({url:g+"/api/client/query_art",method:"POST",data:{username:a,access_token:t,art_id:i,art_cat_id:o,shop_type:r},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(a){a.data.result;e.setData({agreementInfo:a.data.result}),console.log(n("送心协议:",e.agreementInfo," at pages\\my\\index.vue:715")),e.modalHiddenPlaysx=!0,e.article=e.agreementInfo[0]["desc"].replace("<img",'<img style="max-width:100%;height:auto;margin:0 auto;" '),e.article_title="送心协议"}})):(e.article_title="送心协议",e.modalHiddenPlaysx=!0,e.article=e.agreementInfo[0]["desc"].replace("<img",'<img style="max-width:100%;height:auto;margin:0 auto;" '))},showPlaysxinfo:function(){var a=this,t=this.modalHiddenPlaysx,n=this.playsxinfoshowflag;this.playsxInfo;if(a.setData({modalHiddenPlaysx:!t}),!this.modalHiddenPlaysx&&0==n){e.getSystemInfo({success:function(e){var t=e.windowHeight;a.setData({dkheight:t-.05*t-20})}}),this.setData({playsxinfoshowflag:1});var i=this.playsxInfo[0]["desc"].replace("<img",'<img style="max-width:100%;height:auto;margin:0 auto;" ');c.wxParse("dkcontent2","html",i,winPage,5)}},navigateToPlaysx:function(){var a=this,t=e.getStorageSync("username")?e.getStorageSync("username"):"",i=e.getStorageSync("token")?e.getStorageSync("token"):"1",o=a.art_id?a.art_id:"22",r=a.art_cat_id?a.art_cat_id:"9",s=(a.art_title&&a.art_title,a.playsxinfoshowflag);0==s?(wx.showToast({title:"加载中",icon:"loading",duration:1e3}),wx.request({url:g+"/api/client/query_art",method:"POST",data:{username:t,access_token:i,art_id:o,art_cat_id:r},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){var t=e.data.result;a.playsxInfo=t,console.log(n("玩转送心:",a.playsxInfo," at pages\\my\\index.vue:787")),a.modalHiddenPlaysx=!0,a.article_title="玩转送心",a.article=t[0]["desc"].replace("<img",'<img style="max-width:100%;height:auto;margin:0 auto;" ')}})):(a.article_title="玩转送心",a.modalHiddenPlaysx=!a.modalHiddenPlaysx,a.article=a.playsxInfo[0]["desc"].replace("<img",'<img style="max-width:100%;height:auto;margin:0 auto;" '))},navigateToArticle:function(){var a=this,t=e.getStorageSync("username")?e.getStorageSync("username"):"",i=e.getStorageSync("token")?e.getStorageSync("token"):"1";wx.showToast({title:"加载中",icon:"loading",duration:1e3}),e.request({url:g+"/api/client/query_art",method:"POST",data:{username:t,access_token:i,shop_type:m,art_type:1},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){if(console.log(n("文章信息：",e.data.result," at pages\\my\\index.vue:844")),"y"==e.data.status){var t=e.data.result;a.article_title="送心文章",a.modalHiddenPlaysx=!a.modalHiddenPlaysx,a.article=t[0]["desc"].replace("<img",'<img style="max-width:100%;height:auto;margin:0 auto;" ')}else wx.showToast({title:"暂时没有文章",icon:"loading",duration:1500})}})},showAgreementinfo:function(){var a=this,t=a.modalHiddenAgreement,i=a.agreementinfoshowflag?a.agreementinfoshowflag:0;this.setData({modalHiddenAgreement:!t}),a.modalHiddenAgreement||0!=i||(e.getSystemInfo({success:function(e){var t=e.windowHeight;console.log(n(t," at pages\\my\\index.vue:872")),a.setData({dkheight:t-.05*t-120})}}),a.setData({agreementinfoshowflag:1}),c.wxParse("dkcontent1","html",a.data.agreementInfo[0]["desc"],a,5))},showArt:function(){var e=this,a=e.data.modalHiddenArt,t=e.data.modalHiddenArtInfo,i=e.data.artinfoshowflag,o=e.data.art_index?e.data.art_index:0;if(e.setData({modalHiddenArt:!a,modalHiddenArtInfo:!t}),console.log(n("my index showArt() modalHiddenArtInfo:",t,"artinfoshowflag:",i,"art_index:",o," at pages\\my\\index.vue:895")),!e.data.modalHiddenArtInfo&&0==i){wx.getSystemInfo({success:function(a){var t=a.windowHeight;console.log(n("my index showArt():",t,"art_index:",o," at pages\\my\\index.vue:901")),e.setData({dkheight:t-.05*t-120})}}),e.setData({artinfoshowflag:1,art_index:o});var r=e.data.article[o]["desc"].replace("<img ",'<img style="max-width:100%;height:auto;margin:0 auto;" ');c.wxParse("dkcontent2","html",r,e,5)}},navigateToMyLocation:function(e){wx.navigateTo({url:"../member/mylocation/mylocation?"})},navigateToAccount:function(e){wx.navigateTo({url:"../member/account/account?"})},navigateToCustomerService:function(){var a=e.getStorageSync("username")?e.getStorageSync("username"):"",t="http://wpa.qq.com/msgrd?v=3&uin=198895160&site=qq&menu=yes";e.request({url:g+"/api/client/query_webview_url",method:"POST",data:{username:a,access_token:p,shop_type:m,webview_type:"1"},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){if(console.log(n("web view url：",e.data.result," at pages\\my\\index.vue:952")),"y"==e.data.status){var a=e.data.result;t=a.url,plus.runtime.openURL(t,function(e){plus.nativeUI.alert("本机没有安装QQ，无法启动")})}else wx.showToast({title:"暂时没有WEBVIEW URL",icon:"none",duration:1500})}})},navigateToWishlist:function(e){wx.navigateTo({url:"../wish/wish"})},navigateToShopowner:function(e){wx.navigateTo({url:"../member/shopowner/shopowner?"})},navigateToCelebration:function(e){var a=this,t=a.shop_type;wx.request({url:g+"/api/client/get_project_gift_para",method:"POST",data:{username:_,access_token:p,shop_type:t,type:1},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log(n(e.data.result," at pages\\my\\index.vue:1004"));var t=e.data.result;a.setData({webviewurl:t,modalHiddenCele:!a.modalHiddenCele})}})},bindCelePickerChange:function(e){var a=this,t=e.detail.value,i=a.webviewurl[t]["url"],o=a.webviewurl[t]["id"];console.log(n("celebration picker发送选择改变，携带值为",e.detail.value," at pages\\my\\index.vue:1018")),a.setData({web_url:i,web_id:o,index:t})},modalBindconfirmCele:function(){var e=this;e.setData({modalHiddenCele:!e.modalHiddenCele}),wx.navigateTo({url:"../member/aboutus/aboutus?url="+e.web_url})},modalBindcancelCele:function(){var e=this;e.setData({modalHiddenCele:!e.modalHiddenCele})},modalBindconfirmPhone:function(){var e=this,a=wx.getStorageSync("user_phone")?wx.getStorageSync("user_phone"):"";if(a)e.setData({modalHiddenPhone:!e.modalHiddenPhone});else{var t="需要您的手机号授权";e.setData({needPhoneNumber:t})}},bindArtPickerChange:function(e){var a=this,t=e.detail.value,i=a.article[t]["title"],o=a.article[t]["image"],r=a.article[t]["id"],s=a.article[t]["cat_id"];console.log(n("article picker发送选择改变，携带值为",e.detail.value," at pages\\my\\index.vue:1065")),a.setData({art_title:i,art_id:r,art_cat_id:s,art_index:t,art_image:o||a.share_art_image})},modalBindconfirmArt:function(){var e=this;e.showArt()},modalBindcancelArt:function(){var e=this;e.setData({modalHiddenArtInfo:!0,modalHiddenArt:!0,artinfoshowflag:0})},modalBindconfirmArtInfo:function(){var e=this;e.setData({modalHiddenArtInfo:!0,modalHiddenArt:!0,artinfoshowflag:0}),e.setData({art_id:0,art_cat_id:0})},modalBindShareArtInfo:function(){var e=this;e.setData({modalHiddenArtInfo:!0,modalHiddenArt:!0,artinfoshowflag:0});var a=e.art_index,t=e.article[a]["title"],n=e.article[a]["image"]?e.article[a]["image"]:e.share_art_image,i=e.article[a]["id"],o=e.article[a]["cat_id"],r=e.article[a]["wx_headimg"];wx.navigateTo({url:"/pages/wish/wishshare/wishshare?share_art_id="+i+"&share_art_cat_id="+o+"&share_art_image="+n+"&share_art_wx_headimg="+r+"&share_art_title="+t}),e.setData({art_id:0,art_cat_id:0})},navigateToMessage:function(e){wx.navigateTo({url:"../member/message/message?"})},modalBindconfirmBankcard:function(){var e=this;e.setData({modalHiddenBankcard:!e.modalHiddenBankcard}),e.band_bank_card()},modalBindcancelBankcard:function(){var e=this;e.setData({modalHiddenBankcard:!e.modalHiddenBankcard})},modalBindconfirmAgreement:function(){var e=this;e.setData({modalHiddenAgreement:!e.modalHiddenAgreement}),wx.setStorageSync("isReadAgreement",1),e.goBack()},modalBindcancelAgreement:function(){this.setData({modalHiddenAgreement:!this.modalHiddenAgreement})},modalBindconfirmPlaysx:function(){this.setData({modalHiddenPlaysx:!this.modalHiddenPlaysx,art_id:0,art_cat_id:0,playsxinfoshowflag:0}),"送心协议"==this.article_title&&(this.setData({modalHiddenAgreement:!this.modalHiddenAgreement}),e.setStorageSync("isReadAgreement",1))},modalBindcancelPlaysx:function(){this.setData({modalHiddenPlaysx:!this.modalHiddenPlaysx,art_id:0,art_cat_id:0,playsxinfoshowflag:0})},get_project_gift_para:function(){var e=this,a=wx.getStorageSync("navList2")?wx.getStorageSync("navList2"):[{}],t=e.shop_type,i=e.hall_banner;console.log(n("hall get_project_gift_para navList2:",a," at pages\\my\\index.vue:1233")),0==y.length?wx.request({url:g+"/api/client/get_project_gift_para",method:"POST",data:{type:2,shop_type:t,query_type:"APP"},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(t){console.log(n("get_project_gift_para:",t.data.result," at pages\\my\\index.vue:1251")),a=t.data.result,a&&(wx.setStorageSync("navList2",a),e.setData({navList2:a,hall_banner:a[3]?a[3]:i,middle1_img:a[11]["img"],middle2_img:a[12]["img"],middle3_img:a[13]["img"],middle4_img:a[14]["img"],middle1_title:a[11]["title"],middle2_title:a[12]["title"],middle3_title:a[13]["title"],middle4_title:a[14]["title"],middle1_note:a[11]["note"],middle2_note:a[12]["note"],middle3_note:a[13]["note"],middle4_note:a[14]["note"]}))}}):e.setData({navList2:a,hall_banner:a[3]?a[3]:i,middle1_img:a[11]["img"],middle2_img:a[12]["img"],middle3_img:a[13]["img"],middle4_img:a[14]["img"],middle1_title:a[11]["title"],middle2_title:a[12]["title"],middle3_title:a[13]["title"],middle4_title:a[14]["title"],middle1_note:a[11]["note"],middle2_note:a[12]["note"],middle3_note:a[13]["note"],middle4_note:a[14]["note"]}),setTimeout(function(){e.setData({loadingHidden:!0})},1500)},chooseImage:function(){var e=d(i.default.mark(function e(){var a,t=this,o=arguments;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a=o.length>0&&void 0!==o[0]?o[0]:0,wx.chooseImage({sizeType:["original","compressed"],success:function(e){t.setData({new_img_arr:e.tempFilePaths}),console.log(n("本次上传图片本地:",t.new_img_arr," at pages\\my\\index.vue:1319")),t.upload(a)},fail:function(e){e["code"]&&0!==e.code&&t.checkPermission(e.code)}});case 2:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}(),upload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=this,t=a.new_img_arr[0],n="";n=0==e?"头像":"用户资料",t&&wx.uploadFile({url:w,filePath:t,name:"wechat_upimg",formData:{latitude:encodeURI(0),longitude:encodeURI(0),restaurant_id:encodeURI(0),city:encodeURI("杭州"),prov:encodeURI("浙江"),name:encodeURI(n)},success:function(t){var i=JSON.parse(t.data.trim());"y"==i["status"]?0==e&&(a.avatarUrl=i["result"]["img_url"],a.update_userinfo()):wx.showToast({title:n+"图片加载失败，请再试一次",icon:"none",duration:2e3})}})},login:function(){wx.navigateTo({url:"/pages/login/login?frompage=/pages/my/index"})},navigateToAboutus:function(){wx.navigateTo({url:"/pages/member/aboutus/aboutus"})},navigateToDonate:function(){wx.navigateTo({url:"/pages/member/donate/donate"})},image_save:function(e,a){var t=this;console.log(n("membershare imge save image url:",e,"image_cache_name:",a," at pages\\my\\index.vue:1394")),wx.downloadFile({url:e,success:function(e){if(200===e.statusCode){var i=e.tempFilePath,o=wx.getFileSystemManager();o.saveFile({tempFilePath:e.tempFilePath,success:function(e){wx.setStorageSync(a,e.savedFilePath),console.log(n("membershare image_save 用户分享图片缓存成功",a,e.savedFilePath," at pages\\my\\index.vue:1408"))},fail:function(e){console.log(n(" membershare image_save 用户图片缓存失败",a,e," at pages\\my\\index.vue:1412"));var r=wx.getStorageSync("wx_headimg_cache"),s=wx.getStorageSync("membershare_qrcode_cache_"+t.act_id);o.getSavedFileList({success:function(e){console.log(n("membershare getSavedFileList 缓存文件列表",e," at pages\\my\\index.vue:1417"));for(var t=0;t<e.fileList.length;t++)e.fileList[t]["filePath"]!=r&&e.fileList[t]["filePath"]!=s&&o.removeSavedFile({filePath:e.fileList[t]["filePath"],success:function(e){console.log(n("membershare image_save 缓存清除成功",e," at pages\\my\\index.vue:1425"))},fail:function(e){console.log(n("membershare image_save 缓存清除失败",e," at pages\\my\\index.vue:1429"))}});o.saveFile({tempFilePath:i,success:function(e){wx.setStorageSync(a,e.savedFilePath)}})},fail:function(e){console.log(n("membershare getSavedFileList 缓存文件列表查询失败",e," at pages\\my\\index.vue:1448"))}})}})}else console.log(n("membershare image_save 响应失败",e.statusCode," at pages\\my\\index.vue:1456"))}})},navigateToShare:function(){wx.getStorageSync("m_id")&&wx.getStorageSync("m_id");wx.navigateTo({url:"/pages/member/share/share?qr_type=membershare"})},navigateToCoupon:function(){wx.navigateTo({url:"/pages/member/couponsnd/couponsnd"})},navigateToMyCoupon:function(){wx.navigateTo({url:"/pages/member/couponmy/couponmy"})},navigateToMyRedpackage:function(){wx.navigateTo({url:"/pages/member/couponmy/couponmy?red=1"})},setData:function(e){var a,t,n=this,i=[];Object.keys(e).forEach(function(o){i=o.split("."),a=e[o],t=n.$data,i.forEach(function(e,o){o+1==i.length?n.$set(t,e,a):t[e]||n.$set(t,e,{}),t=t[e]})})}}};a.default=v}).call(this,t("6e42")["default"],t("0de9")["default"])},7020:function(e,a,t){"use strict";t.r(a);var n=t("1f54"),i=t("e568");for(var o in i)"default"!==o&&function(e){t.d(a,e,function(){return i[e]})}(o);t("94a3");var r=t("2877"),s=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,null,null);a["default"]=s.exports},"94a3":function(e,a,t){"use strict";var n=t("bc99"),i=t.n(n);i.a},bc99:function(e,a,t){},e568:function(e,a,t){"use strict";t.r(a);var n=t("54ec"),i=t.n(n);for(var o in n)"default"!==o&&function(e){t.d(a,e,function(){return n[e]})}(o);a["default"]=i.a},feed:function(e,a,t){"use strict";(function(e){t("ee7a"),t("921b");n(t("66fd"));var a=n(t("7020"));function n(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,t("6e42")["createPage"])}},[["feed","common/runtime","common/vendor"]]]);