(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-address-add-add"],{1881:function(e,t,a){"use strict";var n=a("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("28a5");var i=n(a("a4bb"));a("ac6a");var r,o=n(a("e814")),s=getApp().globalData.weburl,c=a("ef60"),l=getApp().globalData.mapkey,d=(a("3936"),(new Date).getTime()),u=getApp().globalData.shop_type,f=getApp().globalData.uploadurl,p={data:function(){return{current:0,username:null,token:null,addressId:null,province:[],city:[],region:[],town:[],provinceId:[],cityId:[],regionId:[],townId:[],provinceObjects:[],cityObjects:[],regionObjects:[],townObjects:[],areaSelectedStr:"请选择省市区",full_name:"",maskVisual:"hidden",provinceName:"请选择",shop_type:u,uploadurl:f,img_arr:[],new_img_arr:[],upimg_url:[],formdata:"",currenttime:d?(0,o.default)(d/1e3):0,qqmapkey:l,endtime:"",activity_name:"",detail:"",mobile:"",new_img_url:"",address:"",animationData:"",regionName:"",townName:"",provinceIndex:"",cityIndex:"",regionIndex:"",townIndex:"",cityName:"",latitude:"",longitude:"",is_activity:0,is_buymyself:0}},components:{},props:{},onLoad:function(e){var t=this,a=e.is_buymyself?e.is_buymyself:0,n=e.is_activity?e.is_activity:0,i=t.qqmapkey;r=new c({key:i});t=this;var o=wx.getStorageSync("username")?wx.getStorageSync("username"):"",l=wx.getStorageSync("token")?wx.getStorageSync("token"):"1";o||wx.navigateTo({url:"../login/login?is_permission=1"}),t.is_buymyself=a,t.is_activity=n,t.setData({username:o,token:l}),wx.request({url:s+"/api/client/get_area_list",method:"POST",data:{parent_id:0},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){for(var a=e.data.result,n=[],i=0;i<a.length;i++)n[i]=a[i]["area_name"];t.setData({province:n,provinceObjects:a})}}),1==n?t.loadAddress_activity(e):t.loadAddress_member(e),t.cascadePopup()},methods:{formSubmit:function(e){var t=this,a=this.username,n=this.token,i=t.areaSelectedStr,r=e.detail.value.detail,o=e.detail.value.activity_name,s=e.detail.value.mobile,c=e.detail.value.full_name,l=e.detail.value.waitting,d=t.currenttime+60*l*60,u=t.is_activity?t.is_activity:0;t.is_buymyself&&t.is_buymyself;"请选择省市区"!=i&&""!=i?""!=r?""!=o||1!=u?/^1[34578]\d{9}$/.test(s)?(t.setData({username:a,token:n,endtime:d,activity_name:o,detail:r,mobile:s,full_name:c}),1==u?t.upload():t.update_member_address()):wx.showToast({title:"请填写正确手机号码"}):wx.showToast({title:"请填写备注"}):wx.showToast({title:"请填写详情地址"}):wx.showToast({title:"请输入区域"})},upload:function(){for(var e=this,t=wx.getStorageSync("username")?wx.getStorageSync("username"):"",a=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",n=e.goods_id,i=e.new_img_arr,r=[],o=e.provinceObjects[e.provinceIndex],c=e.cityObjects[e.cityIndex],l=e.regionObjects[e.regionIndex],d=e.townObjects[e.townIndex],u=e.addressId,p=e.endtime,g=(e.activity_image,e.activity_name),v=e.detail,m=e.areaSelectedStr+e.detail,w=e.mobile,_=(e.latitude,e.longitude,0);_<i.length;_++){var h=i.length;wx.uploadFile({url:f,filePath:i[_],name:"wechat_upimg",formData:{latitude:encodeURI(0),longitude:encodeURI(0),restaurant_id:encodeURI(0),city:encodeURI("杭州"),prov:encodeURI("浙江"),name:encodeURI(n)},success:function(n){var i=JSON.parse(n.data.trim());"y"==i["status"]&&(r.push(i["result"]["img_url"]),e.setData({new_img_url:r}),h--,console.log("图片上传完成:",e.new_img_url," count:",h),0==h&&wx.request({url:s+"/api/client/update_activity_address",method:"POST",data:{username:t,access_token:a,id:u,activity_name:g,prov:o?o.area_id:"",city:c?c.area_id:"",area:l?l.area_id:"",town:d?d.area_id:"",address:m,address_name:v,tel:w,image:r[0]?r[0]:"",image2:r[1]?r[1]:"",image3:r[2]?r[2]:"",endtime:p,latitude:e.latitude,longitude:e.longitude},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log(e.data.result),console.log(e.data.info),(e.data.status="y")?(wx.showToast({title:"保存成功",duration:1e3}),setTimeout(function(){wx.navigateBack()},500)):wx.showToast({title:"保存失败",content:e.data.info,duration:2e3})},function:function(e){console.log(e)}}))}})}},update_member_address:function(){var e=this,t=wx.getStorageSync("username")?wx.getStorageSync("username"):"",a=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",n=e.provinceObjects[e.provinceIndex],i=e.cityObjects[e.cityIndex],r=e.regionObjects[e.regionIndex],o=e.townObjects[e.townIndex],c=e.addressId?e.addressId:0,l=e.shop_type,d=e.detail,u=e.areaSelectedStr+e.detail,f=e.mobile,p=e.full_name;wx.request({url:s+"/api/client/update_member_address",method:"POST",data:{username:t,access_token:a,shop_type:l,id:c,prov:n?n.area_id:"",city:i?i.area_id:"",area:r?r.area_id:"",town:o?o.area_id:"",address:u,address_name:d,tel:f,full_name:p},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log(e.data.result),console.log(e.data.info),wx.showToast({title:"保存成功",duration:500}),setTimeout(function(){wx.navigateBack()},500)},function:function(e){console.log(e)}})},upimg:function(){var e=this,t=e.new_img_arr,a=e.img_arr;console.log("upimg img_arr:",a),a.length+t.length<3?wx.chooseImage({sizeType:["original","compressed"],success:function(a){e.setData({new_img_arr:t.concat(a.tempFilePaths)}),console.log("本次上传图片:",e.new_img_arr)}}):wx.showToast({title:"最多上传三张图片",icon:"loading",duration:3e3})},cancel_upimg:function(e){var t=this,a=e.currentTarget.dataset.id,n=[],i=t.img_arr,r=0;console.log("cancel_upimg:",i.length,"id:",a);for(var o=0;o<i.length;o++)o!=a&&(n[r++]=i[o]);t.setData({img_arr:n})},cancel_new_upimg:function(e){var t=this,a=e.currentTarget.dataset.id,n=[],i=(t.img_arr,t.new_img_arr),r=0;console.log("cancel_upimg:",i.length,"id:",a);for(var o=0;o<i.length;o++)o!=a&&(n[r++]=i[o]);t.setData({new_img_arr:n})},loadAddress_activity:function(e){var t=this,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",n=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",i=t.shop_type,r=e.objectId,o=t.img_arr;console.log("loadAddress addressId:",r),void 0!=r&&(t.setData({addressId:r}),wx.request({url:s+"/api/client/get_activity_address",method:"POST",data:{username:e.username?e.username:a,access_token:n,shop_type:i,address_id:r},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log("loadAddress:",e.data.result);for(var a=e.data.result,n=[],i=0;i<a.length;i++)n[i]=a[i]["address"],"undefined"!=a["img"]&&""!=a["img"]&&(o[0]=a["img"]),"undefined"!=a["img2"]&&""!=a["img2"]&&(o[1]=a["img2"]),"undefined"!=a["img3"]&&""!=a["img3"]&&(o[2]=a["img3"]);t.setData({address:a[0],img_arr:o,areaSelectedStr:a[0]["prov_str"]+a[0]["city_str"]+a[0]["area_str"]+a[0]["town_str"]}),console.log(t.img_arr)}}))},loadAddress_member:function(e){var t=this,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",n=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",i=t.shop_type,r=e.objectId;console.log("loadAddress addressId:",r),void 0!=r&&(t.setData({addressId:r}),wx.request({url:s+"/api/client/get_member_address",method:"POST",data:{username:e.username?e.username:a,access_token:n,shop_type:i,address_id:r},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log("loadAddress:",e.data.result);for(var a=e.data.result,n=[],i=0;i<a.length;i++)n[i]=a[i]["address"];t.setData({address:a[0],areaSelectedStr:a[0]["prov_str"]+a[0]["city_str"]+a[0]["area_str"]+a[0]["town_str"]}),console.log("load member address:",t.address)}}))},setDefault:function(){var e=this;console.log(e.provinceObjects)},cascadePopup:function(){var e=wx.createAnimation({duration:500,timingFunction:"ease-in-out"});this.animation=e,e.translateY(-285).step(),this.setData({animationData:this.animation.export(),maskVisual:"show"})},cascadeDismiss:function(){this.animation.translateY(285).step(),this.setData({animationData:this.animation.export(),maskVisual:"hidden"})},provinceTapped:function(e){var t=e.currentTarget.dataset.index;console.log("provinceTapped"),console.log(""),this.setData({provinceName:this.province[t],regionName:"",townName:"",provinceIndex:t,cityIndex:-1,regionIndex:-1,townIndex:-1,region:[],town:[]});var a=this,n=this.provinceObjects[t]["area_id"];wx.request({url:s+"/api/client/get_area_list",method:"POST",data:{parent_id:n},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log(e.data.result);for(var t=e.data.result,n=[],i=0;i<t.length;i++)n[i]=t[i]["area_name"];a.setData({cityName:"请选择",city:n,cityObjects:t}),a.setData({current:1})}})},cityTapped:function(e){var t=e.currentTarget.dataset.index;this.setData({cityIndex:t,regionIndex:-1,townIndex:-1,cityName:this.city[t],regionName:"",townName:"",town:[]});var a=this,n=this.cityObjects[t]["area_id"];wx.request({url:s+"/api/client/get_area_list",method:"POST",data:{parent_id:n},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log(e.data.result);for(var t=e.data.result,n=[],i=0;i<t.length;i++)n[i]=t[i]["area_name"];a.setData({regionName:"请选择",region:n,regionObjects:t}),a.setData({current:2})}})},regionTapped:function(e){var t=e.currentTarget.dataset.index;this.setData({regionIndex:t,townIndex:-1,regionName:this.region[t],townName:""});var a=this,n=this.regionObjects[t]["area_id"];wx.request({url:s+"/api/client/get_area_list",method:"POST",data:{parent_id:n},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(e){console.log(e.data.result);var t=e.data.result;if(0==t.length){var n=a.provinceName+a.cityName+a.regionName;return a.setData({areaSelectedStr:n}),void a.cascadeDismiss()}for(var i=[],r=0;r<t.length;r++)i[r]=t[r]["area_name"];a.setData({townName:"请选择",town:i,townObjects:t}),a.setData({current:3}),console.log(a.townObjects)}})},townTapped:function(e){var t=e.currentTarget.dataset.index;this.setData({townIndex:t,townName:this.town[t]});var a=this.provinceName+this.cityName+this.regionName+this.townName;this.setData({areaSelectedStr:a}),this.cascadeDismiss()},currentChanged:function(e){var t=e.detail.current;this.setData({current:t})},changeCurrent:function(e){var t=e.currentTarget.dataset.current;this.setData({current:t})},fetchPOI:function(){var e=this;r.reverseGeocoder({poi_options:"policy=2",get_poi:1,success:function(t){console.log("获取当前位置 fetchPOI:",t),e.setData({areaSelectedStr:t.result.address+t.result.formatted_addresses.recommend,latitude:t.result.location.lat,longitude:t.result.location.lng})},fail:function(e){},complete:function(e){}})},setData:function(e){var t,a,n=this,r=[];(0,i.default)(e).forEach(function(i){r=i.split("."),t=e[i],a=n.$data,r.forEach(function(e,i){i+1==r.length?n.$set(a,e,t):a[e]||n.$set(a,e,{}),a=a[e]})})}}};t.default=p},3936:function(e,t,a){"use strict";var n=a("288e");a("3b2b");var i=n(a("768b")),r=n(a("795b"));a("28a5"),a("a481");var o=n(a("e814"));function s(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),i=e.getHours(),r=e.getMinutes(),o=e.getSeconds();return[t,a,n].map(l).join("-")+" "+[i,r,o].map(l).join(":")}function c(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a=e?new Date(e):new Date,a.setDate(a.getDate()+t);var i=a.getFullYear(),r=a.getMonth()+1,o=a.getDate(),s=a.getHours(),c=a.getMinutes(),l=a.getSeconds();return r<10&&(r="0"+r),o<10&&(o="0"+o),s<10&&(s="0"+s),c<10&&(c="0"+c),l<10&&(l="0"+l),0==n?i+"-"+r+"-"+o:1==n?s+":"+c:2==n?s+":"+c+":"+l:i+"-"+r+"-"+o}function l(e){return e=e.toString(),e[1]?e:"0"+e}function d(e){var t,a=6e4,n=60*a,i=24*n,r=30*i,s=365*i,c=(new Date).getTime(),l=c-e;if(l<0)return"数据出错";var d=l/s,u=l/r,f=l/(7*i),p=l/i,g=l/n,v=l/a;return t=d>=1?(0,o.default)(d)+"年以前":u>=1?(0,o.default)(u)+"个月前":f>=1?(0,o.default)(f)+"星期前":p>=1?(0,o.default)(p)+"天前":g>=1?(0,o.default)(g)+"小时前":v>=5?(0,o.default)(v)+"分钟前":"刚刚发表",t}function u(e){if("string"==typeof e)return e=e.replace(/\ +/g,""),e=e.replace(/[\r\n]/g,""),e;console.log("去除回车换行空格失败！参数不是字符串类型")}function f(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new Date(e.replace(/-/g,"/")),i=new Date(t.replace(/-/g,"/")),r=i.getTime()-n.getTime(),s=(0,o.default)(r/864e5);return 0==a?r:1==a?s:void 0}function p(e){var t=e.replace(/[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F]|[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF]|[0-9|*|#]\uFE0F\u20E3|[0-9|#]\u20E3|[\u203C-\u3299]\uFE0F\u200D|[\u203C-\u3299]\uFE0F|[\u2122-\u2B55]|\u303D|[\A9|\AE]\u3030|\uA9|\uAE|\u3030/gi,"");return t}function g(e,t){e=e.split("."),t=t.split(".");var a=Math.max(e.length,t.length);while(e.length<a)e.push("0");while(t.length<a)t.push("0");for(var n=0;n<a;n++){var i=(0,o.default)(e[n]),r=(0,o.default)(t[n]);if(i>r)return 1;if(i<r)return-1}return 0}function v(e){var t="tmp_base64src";return new r.default(function(a,n){if(wx.getFileSystemManager){var r=wx.getFileSystemManager(),o=/data:image\/(\w+);base64,(.*)/.exec(e)||[],s=(0,i.default)(o,3),c=s[1],l=s[2];c||n(new Error("ERROR_BASE64SRC_PARSE"));var d="".concat(wx.env.USER_DATA_PATH,"/").concat(t,".").concat(c),u=wx.base64ToArrayBuffer(l);r.writeFile({filePath:d,data:u,encoding:"binary",success:function(){a(d)},fail:function(){n(new Error("ERROR_BASE64SRC_WRITE"))}})}else n(new Error("微信版本过低"))})}function m(){var e="ios";try{var t=wx.getSystemInfoSync();e=t.platform}catch(a){}return e}function w(e,t){return Math.round(e/(e+t)*1e4)/100+"%"}function _(e){return RegExp(/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/).test(e)}function h(e){return RegExp(/^1[34578]\d{9}$/).test(e)}a("6b54"),a("87b3"),e.exports={formatTime:s,getDateDiff:d,getDateStr:c,formatString:u,calDateDiff:f,compareVersion:g,filterEmoji:p,checkPhoneNumber:h,base64src:v,getPlatform:m,percentage:w,checkEmail:_}},"4d99":function(e,t,a){t=e.exports=a("2350")(!1),t.push([e.i,"uni-page-body[data-v-db1221f0]{position:relative;height:100%}\r\n\r\n/*省市区文本框*/.area_select[data-v-db1221f0]{color:grey;width:60%}.poi[data-v-db1221f0]{font-size:12px}\r\n\r\n/*弹窗主体*/.modal-content[data-v-db1221f0]{position:fixed;bottom:-150px;left:0;width:100%;height:285px;\r\n\t/*box-shadow: 10rpx 0 30rpx rgba(0,0,0,.9);*/margin-top:5px;background:#fff;z-index:999}\r\n\r\n/*遮罩层*/.modal-mask[data-v-db1221f0]{position:absolute;top:0;left:0;width:100%;height:100%;background:#000;opacity:.8;z-index:99}\r\n\r\n/*弹窗头部*/.modal-header[data-v-db1221f0]{margin:2px 0;font-size:16px;color:#666;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;line-height:30px}\r\n\r\n/*所在地区字样*/.modal-title[data-v-db1221f0]{text-align:center;width:100%}\r\n\r\n/*关闭按钮*/.modal-close[data-v-db1221f0]{width:20px}.modal-body[data-v-db1221f0]{font-size:14px}\r\n\r\n/*每级地区标题*/.viewpager-title[data-v-db1221f0]{padding:0 10px;\r\n\t/*color: #f03118;*/line-height:30px}\r\n\r\n/*分隔线*/.viewpager-divider[data-v-db1221f0]{width:100%;height:1px;background:#ccc}\r\n\r\n/*左右滑动控件*/.swiper-area[data-v-db1221f0]{height:220px}\r\n\r\n/*地址列表ListView容器*/.viewpager-listview[data-v-db1221f0]{padding-top:5px;height:100%}\r\n\r\n/*每行地址item项*/.viewpager-listview uni-view[data-v-db1221f0]{line-height:30px;padding:0 10px}\r\n\r\n/*高亮当前所选地区*/.area-selected[data-v-db1221f0]{color:red}\r\n\r\n/*初始隐藏*/.hidden[data-v-db1221f0]{display:none}\r\n\r\n/*运行时显示*/.show[data-v-db1221f0]{display:block}\r\n\r\n/*单元格*/.cell[data-v-db1221f0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:4px;border-bottom:1px solid #eee;line-height:28px}.cell[data-v-db1221f0]:last-child{border-bottom:0}\r\n\r\n/*label显示字符*/.cell uni-text[data-v-db1221f0]:first-child{width:50px}\r\n\r\n/*请选择区域*/.region[data-v-db1221f0]{width:90%}\r\n\r\n/*保存按钮*/.save[data-v-db1221f0]{margin:8px}.upimg[data-v-db1221f0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.upimage[data-v-db1221f0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding:0 %?20?%}.upimage uni-image[data-v-db1221f0]{\r\n /*被图片设置宽高*/width:%?80?%;height:%?80?%}.btnjia[data-v-db1221f0]{margin:%?20?%;width:%?96?%;height:%?97?%}",""])},"58df":function(e,t,a){"use strict";var n=a("ae95"),i=a.n(n);i.a},"768b":function(e,t,a){"use strict";a.r(t);var n=a("a745"),i=a.n(n);function r(e){if(i()(e))return e}var o=a("5d73"),s=a.n(o);function c(e,t){var a=[],n=!0,i=!1,r=void 0;try{for(var o,c=s()(e);!(n=(o=c.next()).done);n=!0)if(a.push(o.value),t&&a.length===t)break}catch(l){i=!0,r=l}finally{try{n||null==c["return"]||c["return"]()}finally{if(i)throw r}}return a}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(e,t){return r(e)||c(e,t)||l()}a.d(t,"default",function(){return d})},8265:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("v-uni-form",{on:{submit:function(t){t=e.$handleEvent(t),e.formSubmit(t)}}},[a("v-uni-view",{staticClass:"cell"},[a("v-uni-text",[e._v("区域")]),a("v-uni-text",{staticClass:"area_select",on:{click:function(t){t=e.$handleEvent(t),e.cascadePopup(t)}}},[e._v(e._s(e.areaSelectedStr))]),a("v-uni-text",{staticClass:"poi",on:{click:function(t){t=e.$handleEvent(t),e.fetchPOI(t)}}},[e._v("自动获取")])],1),a("v-uni-view",{staticClass:"cell"},[a("v-uni-text",[e._v("地址")]),a("v-uni-input",{attrs:{name:"detail",placeholder:"请输入详情地址",value:e.address.address}})],1),1==e.is_activity?a("v-uni-view",{staticClass:"cell"},[a("v-uni-text",[e._v("备注")]),a("v-uni-input",{attrs:{name:"activity_name",placeholder:"请输入备注",value:e.address.name}})],1):e._e(),a("v-uni-view",{staticClass:"cell"},[a("v-uni-text",[e._v("收件人")]),a("v-uni-input",{attrs:{name:"full_name",placeholder:"请输入收件人姓名",value:e.address.full_name,type:"text"}})],1),a("v-uni-view",{staticClass:"cell"},[a("v-uni-text",[e._v("手机号")]),a("v-uni-input",{attrs:{name:"mobile",placeholder:"请输入手机号码",value:e.address.tel,type:"number"}})],1),1==e.is_activity?a("v-uni-view",{staticClass:"cell"},[a("v-uni-text",[e._v("侯时")]),a("v-uni-input",{attrs:{name:"waitting",placeholder:"请输入等候时长(小时)",value:e.address.waitting,type:"digit"}})],1):e._e(),a("v-uni-view",{staticClass:"upimage"},[e._l(e.img_arr,function(t,n){return[a("v-uni-image",{key:n+"_0",attrs:{"data-id":n,src:t,mode:"aspectFit"},on:{click:function(t){t=e.$handleEvent(t),e.cancel_upimg(t)}}})]}),e._l(e.new_img_arr,function(t,n){return[a("v-uni-image",{key:n+"_0",attrs:{"data-id":n,src:t,mode:"aspectFit"},on:{click:function(t){t=e.$handleEvent(t),e.cancel_new_upimg(t)}}})]})],2),1==e.is_activity?a("v-uni-view",{staticClass:"upimg",on:{click:function(t){t=e.$handleEvent(t),e.upimg(t)}}},[a("v-uni-image",{staticClass:"btnjia",attrs:{src:"../../../static/images/jia.png"}})],1):e._e(),a("v-uni-button",{staticClass:"save",attrs:{formType:"submit",type:"warn"}},[e._v("保存")])],1),a("v-uni-view",{staticClass:"modal"},[a("v-uni-view",{class:"modal-mask "+e.maskVisual,on:{click:function(t){t=e.$handleEvent(t),e.cascadeDismiss(t)}}}),a("v-uni-view",{staticClass:"modal-content",attrs:{animation:e.animationData}},[a("v-uni-view",{staticClass:"modal-header"},[a("v-uni-text",{staticClass:"modal-title"},[e._v("所在地区")]),a("v-uni-text",{staticClass:"modal-close",on:{click:function(t){t=e.$handleEvent(t),e.cascadeDismiss(t)}}},[e._v("X")])],1),a("v-uni-view",{staticClass:"modal-body"},[a("v-uni-text",{class:"viewpager-title "+(0==e.current?"area-selected":""),attrs:{"data-current":"0"},on:{click:function(t){t=e.$handleEvent(t),e.changeCurrent(t)}}},[e._v(e._s(e.provinceName))]),a("v-uni-text",{class:"viewpager-title "+(1==e.current?"area-selected":""),attrs:{"data-current":"1"},on:{click:function(t){t=e.$handleEvent(t),e.changeCurrent(t)}}},[e._v(e._s(e.cityName))]),a("v-uni-text",{class:"viewpager-title "+(2==e.current?"area-selected":""),attrs:{"data-current":"2"},on:{click:function(t){t=e.$handleEvent(t),e.changeCurrent(t)}}},[e._v(e._s(e.regionName))]),a("v-uni-text",{class:"viewpager-title "+(3==e.current?"area-selected":""),attrs:{"data-current":"3"},on:{click:function(t){t=e.$handleEvent(t),e.changeCurrent(t)}}},[e._v(e._s(e.townName))]),a("v-uni-view",{staticClass:"viewpager-divider"}),a("v-uni-swiper",{staticClass:"swiper-area",attrs:{current:e.current},on:{change:function(t){t=e.$handleEvent(t),e.currentChanged(t)}}},[e.province.length>0?[a("v-uni-swiper-item",[a("v-uni-scroll-view",{staticClass:"viewpager-listview",attrs:{"scroll-y":"true"}},e._l(e.province,function(t,n){return a("v-uni-view",{key:n,attrs:{"data-index":n},on:{click:function(t){t=e.$handleEvent(t),e.provinceTapped(t)}}},[n==e.provinceIndex?a("v-uni-text",{staticClass:"area-selected"},[e._v(e._s(t))]):a("v-uni-text",[e._v(e._s(t))])],1)}),1)],1)]:e._e(),e.city.length>0?[a("v-uni-swiper-item",[a("v-uni-scroll-view",{staticClass:"viewpager-listview",attrs:{"scroll-y":"true"}},e._l(e.city,function(t,n){return a("v-uni-view",{key:n,attrs:{"data-index":n},on:{click:function(t){t=e.$handleEvent(t),e.cityTapped(t)}}},[n==e.cityIndex?a("v-uni-text",{staticClass:"area-selected"},[e._v(e._s(t))]):a("v-uni-text",[e._v(e._s(t))])],1)}),1)],1)]:e._e(),e.region.length>0?[a("v-uni-swiper-item",[a("v-uni-scroll-view",{staticClass:"viewpager-listview",attrs:{"scroll-y":"true"}},e._l(e.region,function(t,n){return a("v-uni-view",{key:n,attrs:{"data-index":n},on:{click:function(t){t=e.$handleEvent(t),e.regionTapped(t)}}},[n==e.regionIndex?a("v-uni-text",{staticClass:"area-selected"},[e._v(e._s(t))]):a("v-uni-text",[e._v(e._s(t))])],1)}),1)],1)]:e._e(),e.town.length>0?[a("v-uni-swiper-item",[a("v-uni-scroll-view",{staticClass:"viewpager-listview",attrs:{"scroll-y":"true"}},e._l(e.town,function(t,n){return a("v-uni-view",{key:n,attrs:{"data-index":n},on:{click:function(t){t=e.$handleEvent(t),e.townTapped(t)}}},[n==e.townIndex?a("v-uni-text",{staticClass:"area-selected"},[e._v(e._s(t))]):a("v-uni-text",[e._v(e._s(t))])],1)}),1)],1)]:e._e()],2)],1)],1)],1)],1)},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},ae95:function(e,t,a){var n=a("4d99");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("35b74fe6",n,!0,{sourceMap:!1,shadowMode:!1})},b1d8:function(e,t,a){"use strict";a.r(t);var n=a("1881"),i=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,function(){return n[e]})}(r);t["default"]=i.a},cd39:function(e,t,a){"use strict";a.r(t);var n=a("8265"),i=a("b1d8");for(var r in i)"default"!==r&&function(e){a.d(t,e,function(){return i[e]})}(r);a("58df");var o=a("2877"),s=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"db1221f0",null);t["default"]=s.exports},ef60:function(e,t,a){"use strict";var n=a("288e");a("28a5");var i=n(a("85f2")),r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s={KEY_ERR:311,KEY_ERR_MSG:"key格式错误",PARAM_ERR:310,PARAM_ERR_MSG:"请求参数信息有误",SYSTEM_ERR:600,SYSTEM_ERR_MSG:"系统错误",WX_ERR_CODE:1e3,WX_OK_CODE:200},c="https://apis.map.qq.com/ws/",l=c+"place/v1/search",d=c+"place/v1/suggestion",u=c+"geocoder/v1/",f=c+"district/v1/list",p=c+"district/v1/getchildren",g=c+"distance/v1/",v={location2query:function(e){if("string"==typeof e)return e;for(var t="",a=0;a<e.length;a++){var n=e[a];t&&(t+=";"),n.location&&(t=t+n.location.lat+","+n.location.lng),n.latitude&&n.longitude&&(t=t+n.latitude+","+n.longitude)}return t},getWXLocation:function(e,t,a){wx.getLocation({type:"gcj02",success:e,fail:t,complete:a})},getLocationParam:function(e){if("string"==typeof e){var t=e.split(",");e=2===t.length?{latitude:e.split(",")[0],longitude:e.split(",")[1]}:{}}return e},polyfillParam:function(e){e.success=e.success||function(){},e.fail=e.fail||function(){},e.complete=e.complete||function(){}},checkParamKeyEmpty:function(e,t){if(!e[t]){var a=this.buildErrorConfig(s.PARAM_ERR,s.PARAM_ERR_MSG+t+"参数格式有误");return e.fail(a),e.complete(a),!0}return!1},checkKeyword:function(e){return!this.checkParamKeyEmpty(e,"keyword")},checkLocation:function(e){var t=this.getLocationParam(e.location);if(!t||!t.latitude||!t.longitude){var a=this.buildErrorConfig(s.PARAM_ERR,s.PARAM_ERR_MSG+" location参数格式有误");return e.fail(a),e.complete(a),!1}return!0},buildErrorConfig:function(e,t){return{status:e,message:t}},buildWxRequestConfig:function(e,t){var a=this;return t.header={"content-type":"application/json"},t.method="GET",t.success=function(t){var a=t.data;0===a.status?e.success(a):e.fail(a)},t.fail=function(t){t.statusCode=s.WX_ERR_CODE,e.fail(a.buildErrorConfig(s.WX_ERR_CODE,result.errMsg))},t.complete=function(t){var n=+t.statusCode;switch(n){case s.WX_ERR_CODE:e.complete(a.buildErrorConfig(s.WX_ERR_CODE,t.errMsg));break;case s.WX_OK_CODE:var i=t.data;0===i.status?e.complete(i):e.complete(a.buildErrorConfig(i.status,i.message));break;default:e.complete(a.buildErrorConfig(s.SYSTEM_ERR,s.SYSTEM_ERR_MSG))}},t},locationProcess:function(e,t,a,n){var i=this;if(a=a||function(t){t.statusCode=s.WX_ERR_CODE,e.fail(i.buildErrorConfig(s.WX_ERR_CODE,t.errMsg))},n=n||function(t){t.statusCode==s.WX_ERR_CODE&&e.complete(i.buildErrorConfig(s.WX_ERR_CODE,t.errMsg))},e.location){if(i.checkLocation(e)){var r=v.getLocationParam(e.location);t(r)}}else i.getWXLocation(t,a,n)}},m=function(){function e(t){if(o(this,e),!t.key)throw Error("key值不能为空");this.key=t.key}return r(e,[{key:"search",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),v.checkKeyword(e)){var a={keyword:e.keyword,orderby:e.orderby||"_distance",page_size:e.page_size||10,page_index:e.page_index||1,output:"json",key:t.key};e.address_format&&(a.address_format=e.address_format),e.filter&&(a.filter=e.filter);var n=e.distance||"1000",i=e.auto_extend||1,r=function(t){a.boundary="nearby("+t.latitude+","+t.longitude+","+n+","+i+")",wx.request(v.buildWxRequestConfig(e,{url:l,data:a}))};v.locationProcess(e,r)}}},{key:"getSuggestion",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),v.checkKeyword(e)){var a={keyword:e.keyword,region:e.region||"全国",region_fix:e.region_fix||0,policy:e.policy||0,output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:d,data:a}))}}},{key:"reverseGeocoder",value:function(e){var t=this;e=e||{},v.polyfillParam(e);var a={coord_type:e.coord_type||5,get_poi:e.get_poi||0,output:"json",key:t.key};e.poi_options&&(a.poi_options=e.poi_options);var n=function(t){a.location=t.latitude+","+t.longitude,wx.request(v.buildWxRequestConfig(e,{url:u,data:a}))};v.locationProcess(e,n)}},{key:"geocoder",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),!v.checkParamKeyEmpty(e,"address")){var a={address:e.address,output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:u,data:a}))}}},{key:"getCityList",value:function(e){var t=this;e=e||{},v.polyfillParam(e);var a={output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:f,data:a}))}},{key:"getDistrictByCityId",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),!v.checkParamKeyEmpty(e,"id")){var a={id:e.id||"",output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:p,data:a}))}}},{key:"calculateDistance",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),!v.checkParamKeyEmpty(e,"to")){var a={mode:e.mode||"walking",to:v.location2query(e.to),output:"json",key:t.key},n=function(t){a.from=t.latitude+","+t.longitude,wx.request(v.buildWxRequestConfig(e,{url:g,data:a}))};e.from&&(e.location=e.from),v.locationProcess(e,n)}}}]),e}();e.exports=m}}]);