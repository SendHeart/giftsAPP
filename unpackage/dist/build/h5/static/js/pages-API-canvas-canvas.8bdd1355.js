(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-API-canvas-canvas"],{"00b4":function(t,e,i){"use strict";var a=i("272f"),n=i.n(a);n.a},"0706":function(t,e,i){"use strict";i.r(e);var a=i("10af"),n=i("eae3");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("00b4");var s=i("2877"),r=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"6d782a8e",null);e["default"]=r.exports},"10af":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("page-head",{attrs:{title:t.title}}),i("v-uni-view",{staticClass:"uni-common-mt"},[i("v-uni-scroll-view",{attrs:{"scroll-y":"true"}},[i("v-uni-image",{staticClass:"share-image",staticStyle:{"margin-top":"20rpx"},attrs:{src:t.shareImage,mode:"aspectFit"}}),i("v-uni-view",{attrs:{hidden:!t.isPainting}},[i("v-uni-canvas",{style:{width:t.width+"px",height:t.height+"px"},attrs:{"canvas-id":"canvas",id:"canvas"}})],1)],1),i("v-uni-scroll-view",{staticClass:"canvas-buttons",attrs:{"scroll-y":"true"}},[t._l(t.names,function(e,a){return[i("v-uni-button",{key:a+"_0",staticClass:"canvas-button",on:{click:function(i){i=t.$handleEvent(i),t.handleCanvasButton(e)}}},[t._v(t._s(e))])]}),i("v-uni-button",{staticClass:"canvas-button",attrs:{type:"primary"},on:{click:function(e){e=t.$handleEvent(e),t.toTempFilePath(e)}}},[t._v("toTempFilePath")])],2)],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"272f":function(t,e,i){var a=i("b31f");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("9df35574",a,!0,{sourceMap:!1,shadowMode:!1})},"6c7b":function(t,e,i){var a=i("5ca1");a(a.P,"Array",{fill:i("36bd")}),i("9c6c")("fill")},b31f:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".canvas-element-wrapper[data-v-6d782a8e]{display:block;margin-bottom:%?100?%}.canvas-element[data-v-6d782a8e]{width:100%;height:%?500?%;background-color:#fff}.canvas-buttons[data-v-6d782a8e]{padding:%?30?% %?50?% %?10?%;width:100%;height:%?360?%;-webkit-box-sizing:border-box;box-sizing:border-box}.canvas-button[data-v-6d782a8e]{float:left;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:40px;line-height:1;width:%?300?%;margin:%?15?% %?12?%}.share-image[data-v-6d782a8e]{margin-top:%?-20?%;width:100%;height:600px}",""])},eae3:function(t,e,i){"use strict";i.r(e);var a=i("ee00"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},ee00:function(t,e,i){"use strict";var a=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("4917"),i("6c7b"),i("7f7f");var n=a(i("f499")),o=a(i("cebc")),s=null,r={data:function(){return{tempFilePath:null,isPainting:!0,shareImage:"",width:100,height:100,posterData:{},paintingData:{views:[]},imageList:[],tempFileList:[],title:"createContext"}},onLoad:function(t){s=uni.createCanvasContext("canvas",this);var e=JSON.parse(t.posterData);this.posterData=e,console.log("canvas onload options:",e),this.width=e.width,this.height=e.height,setTimeout(function(){},1e3)},onReady:function(){for(var t=this,e=this.posterData,i=(e.width,e.height,e.views),a=(e.background,e.radius,0);a<i.length;a++)if(console.log("canvas onload views.length:",i.length," i:",a),"image"===i[a].type){var n=i[a],r={};r=(0,o.default)({},n),console.log("canvas onload image drawData:",r," i:",a),this.drawImage(r)}else"text"===i[a].type?this.drawText(i[a]):"rect"===i[a].type?this.drawRect(i[a]):"round"===i[a].type&&this.drawRound(i[a]);s.draw(!0,function(){t.toTempFilePath()})},methods:{getImageList:function(t){for(var e=[],i=0;i<t.length;i++)"image"===t[i].type&&e.push(t[i].url);this.imageList=e},toTempFilePath:function(){var t=this;uni.canvasToTempFilePath({canvasId:"canvas",success:function(e){t.shareImage=e.tempFilePath,t.isPainting=!1},fail:function(t){uni.showModal({title:"临时保存失败",content:"draw error:"+(0,n.default)(t)})}})},handleCanvasButton:function(t){this[t]&&this[t]()},_drawRadiusRect:function(t){var e=t.top,i=void 0===e?0:e,a=t.left,n=void 0===a?0:a,o=t.width,r=void 0===o?0:o,l=t.height,d=void 0===l?0:l,c=t.radius,u=void 0===c?0:c,h=n,v=i,f=r,g=d,w=u;s.beginPath(),s.moveTo(h+w,v),s.lineTo(h+f-w,v),s.arc(h+f-w,v+w,w,2*Math.PI*.75,2*Math.PI*1),s.lineTo(h+f,v+g-w),s.arc(h+f-w,v+g-w,w,0,2*Math.PI*.25),s.lineTo(h+w,v+g),s.arc(h+w,v+g-w,w,2*Math.PI*.25,2*Math.PI*.5),s.lineTo(h,v+w),s.arc(h+w,v+w,w,2*Math.PI*.5,2*Math.PI*.75)},drawImage:function(t){t.type,t.background;var e=t.top,i=void 0===e?0:e,a=t.left,n=void 0===a?0:a,o=t.width,r=void 0===o?0:o,l=t.height,d=void 0===l?0:l,c=t.radius,u=void 0===c?0:c,h=t.url,v=void 0===h?"":h,f=t.sx,g=void 0===f?0:f,w=t.sy,p=void 0===w?0:w,b=t.ex,m=void 0===b?0:b,x=t.ey,y=void 0===x?0:x;s.save(),u&&(s.beginPath(),this._drawRadiusRect(t),s.fill(),s.clip()),"tailor"in t?v?(s.drawImage(v,g,p,m,y,n,i,r,d),console.log("canvas drawImage tailor params:",t)):uni.showModal({title:"图片文件不存在",content:"draw url:"+v}):v?(s.drawImage(v,n,i,r,d),console.log("canvas drawImage params:",t)):uni.showModal({title:"图片文件不存在",content:"draw url:"+v}),s.restore()},drawText:function(t){var e=t.MaxLineNumber,i=void 0===e?2:e,a=t.breakWord,n=void 0!==a&&a,r=t.color,l=void 0===r?"black":r,d=t.content,c=void 0===d?"":d,u=t.fontSize,h=void 0===u?16:u,v=t.top,f=void 0===v?0:v,g=t.left,w=void 0===g?0:g,p=t.lineHeight,b=void 0===p?20:p,m=t.textAlign,x=void 0===m?"left":m,y=t.width,T=t.bolder,k=void 0!==T&&T,P=t.textDecoration,I=void 0===P?"none":P;k&&(f-=.3);var M=function(){s.closePath(),s.beginPath(),s.setTextBaseline("top"),s.setFillStyle(l),s.setFontSize(h),s.setTextAlign(x)};if(M(),n){for(var F="",R=f,_=1,L=0,C=0;C<c.length;C++)if(L+=c[C].match(/[^\x00-\xff]/gi)?2:1,F+=[c[C]],s.measureText(F).width>y||(L+3)*uni.upx2px(h)>y){if(_===i&&C!==c.length){F=F.substring(0,F.length-1)+"...",s.fillText(F,w,R),this.drawTextLine(w,R,I,l,h,F),F="";break}s.fillText(F,w,R),this.drawTextLine(w,R,I,l,h,F),F="",L=0,R+=b,_++}s.fillText(F,w,R),this.drawTextLine(w,R,I,l,h,F)}else s.fillText(c,w,f),this.drawTextLine(w,f,I,l,h,c);k&&this.drawText((0,o.default)({},t,{left:w-.3,top:f,bolder:!1,textDecoration:"none"}))},drawTextLine:function(t,e,i,a,n,o){"underline"===i?this.drawRect({background:a,top:e+1.2*n,left:t-1,width:s.measureText(o).width+2,height:1}):"line-through"===i&&this.drawRect({background:a,top:e+.6*n,left:t-1,width:s.measureText(o).width+2,height:1})},drawRect:function(t){var e=t.background,i=t.top,a=void 0===i?0:i,n=t.left,o=void 0===n?0:n,r=t.width,l=void 0===r?0:r,d=t.height,c=void 0===d?0:d;s.save(),s.setFillStyle(e),t.radius?(this._drawRadiusRect(t),s.fill()):(s.setFillStyle(e),s.fillRect(o,a,l,c)),s.restore()}}};e.default=r}}]);