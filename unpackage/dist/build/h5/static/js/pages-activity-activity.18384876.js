(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-activity-activity"],{"00fe":function(t,e,a){"use strict";a.r(e);var i=a("fa13"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a},3936:function(t,e,a){"use strict";var i=a("288e");a("3b2b");var n=i(a("768b")),o=i(a("795b"));a("28a5"),a("a481");var r=i(a("e814"));function c(t){var e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate(),n=t.getHours(),o=t.getMinutes(),r=t.getSeconds();return[e,a,i].map(l).join("-")+" "+[n,o,r].map(l).join(":")}function s(t,e){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a=t?new Date(t):new Date,a.setDate(a.getDate()+e);var n=a.getFullYear(),o=a.getMonth()+1,r=a.getDate(),c=a.getHours(),s=a.getMinutes(),l=a.getSeconds();return o<10&&(o="0"+o),r<10&&(r="0"+r),c<10&&(c="0"+c),s<10&&(s="0"+s),l<10&&(l="0"+l),0==i?n+"-"+o+"-"+r:1==i?c+":"+s:2==i?c+":"+s+":"+l:n+"-"+o+"-"+r}function l(t){return t=t.toString(),t[1]?t:"0"+t}function u(t){var e,a=6e4,i=60*a,n=24*i,o=30*n,c=365*n,s=(new Date).getTime(),l=s-t;if(l<0)return"数据出错";var u=l/c,d=l/o,g=l/(7*n),f=l/n,v=l/i,p=l/a;return e=u>=1?(0,r.default)(u)+"年以前":d>=1?(0,r.default)(d)+"个月前":g>=1?(0,r.default)(g)+"星期前":f>=1?(0,r.default)(f)+"天前":v>=1?(0,r.default)(v)+"小时前":p>=5?(0,r.default)(p)+"分钟前":"刚刚发表",e}function d(t){if("string"==typeof t)return t=t.replace(/\ +/g,""),t=t.replace(/[\r\n]/g,""),t;console.log("去除回车换行空格失败！参数不是字符串类型")}function g(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=new Date(t.replace(/-/g,"/")),n=new Date(e.replace(/-/g,"/")),o=n.getTime()-i.getTime(),c=(0,r.default)(o/864e5);return 0==a?o:1==a?c:void 0}function f(t){var e=t.replace(/[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F]|[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF]|[0-9|*|#]\uFE0F\u20E3|[0-9|#]\u20E3|[\u203C-\u3299]\uFE0F\u200D|[\u203C-\u3299]\uFE0F|[\u2122-\u2B55]|\u303D|[\A9|\AE]\u3030|\uA9|\uAE|\u3030/gi,"");return e}function v(t,e){t=t.split("."),e=e.split(".");var a=Math.max(t.length,e.length);while(t.length<a)t.push("0");while(e.length<a)e.push("0");for(var i=0;i<a;i++){var n=(0,r.default)(t[i]),o=(0,r.default)(e[i]);if(n>o)return 1;if(n<o)return-1}return 0}function p(t){var e="tmp_base64src";return new o.default(function(a,i){if(wx.getFileSystemManager){var o=wx.getFileSystemManager(),r=/data:image\/(\w+);base64,(.*)/.exec(t)||[],c=(0,n.default)(r,3),s=c[1],l=c[2];s||i(new Error("ERROR_BASE64SRC_PARSE"));var u="".concat(wx.env.USER_DATA_PATH,"/").concat(e,".").concat(s),d=wx.base64ToArrayBuffer(l);o.writeFile({filePath:u,data:d,encoding:"binary",success:function(){a(u)},fail:function(){i(new Error("ERROR_BASE64SRC_WRITE"))}})}else i(new Error("微信版本过低"))})}function _(){var t="ios";try{var e=wx.getSystemInfoSync();t=e.platform}catch(a){}return t}function h(t,e){return Math.round(t/(t+e)*1e4)/100+"%"}function b(t){return RegExp(/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/).test(t)}function w(t){return RegExp(/^1[34578]\d{9}$/).test(t)}a("6b54"),a("87b3"),t.exports={formatTime:c,getDateDiff:u,getDateStr:s,formatString:d,calDateDiff:g,compareVersion:v,filterEmoji:f,checkPhoneNumber:w,base64src:p,getPlatform:_,percentage:h,checkEmail:b}},"768b":function(t,e,a){"use strict";a.r(e);var i=a("a745"),n=a.n(i);function o(t){if(n()(t))return t}var r=a("5d73"),c=a.n(r);function s(t,e){var a=[],i=!0,n=!1,o=void 0;try{for(var r,s=c()(t);!(i=(r=s.next()).done);i=!0)if(a.push(r.value),e&&a.length===e)break}catch(l){n=!0,o=l}finally{try{i||null==s["return"]||s["return"]()}finally{if(n)throw o}}return a}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(t,e){return o(t)||s(t,e)||l()}a.d(e,"default",function(){return u})},8620:function(t,e,a){"use strict";a.r(e);var i=a("a64e"),n=a("00fe");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("aa70");var r=a("2877"),c=Object(r["a"])(n["default"],i["a"],i["b"],!1,null,"456c1e00",null);e["default"]=c.exports},a634:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,"/*没有用到iconfont注释降低消耗*/\r\n\r\n/*@import \"../../lib/style/font.css\";\r\n \r\n.Hui-iconfont {\r\n  font-family: \"Hui-iconfont\";\r\n  font-size: 30rpx;\r\n}\r\n\r\n.iconv-uparrow:after {\r\n  content: '\\e6d6';\r\n}\r\n\r\n.iconv-downarrow:after {\r\n  content: '\\e6d5';\r\n}\r\n*/uni-page-body[data-v-456c1e00]{background:#f2f2f2;overflow-x:hidden;width:100%;height:100%}[data-v-456c1e00]::-webkit-scrollbar{width:0;height:0;color:rgba(0,0,0,0)}.banner[data-v-456c1e00]{width:100%;\r\n  /*margin-left: 15rpx;*/background-color:#f2f2f2;background-repeat:norepeat;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;opacity:1}.banner uni-image[data-v-456c1e00]{width:100%}.footer[data-v-456c1e00]{width:100%;background-color:#f2f2f2;background-repeat:norepeat;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;opacity:1;background-size:100% 100%}.footer uni-image[data-v-456c1e00]{width:100%}.wrap[data-v-456c1e00]{width:100%;position:relative;top:%?-15?%}\r\n\r\n/*推荐商品列表*/\r\n\r\n/*推荐商品列表头*/.recomment-title[data-v-456c1e00]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between; /*子项横轴上对齐*/padding:0;color:#444;font-size:%?32?%;font-weight:700}.recomment-title uni-image[data-v-456c1e00]{width:100%}.recomment-title .more[data-v-456c1e00]{font-size:%?24?%;color:#999;font-weight:400;text-align:right}\r\n\r\n/*推荐商品列表头*/.venues-item[data-v-456c1e00]{display:inline-block;width:%?355?%;margin:0 %?10?%;background:#fff;text-indent:%?20?%;padding-bottom:%?10?%}.venues-item .mainpic[data-v-456c1e00]{display:block;width:%?310?%;height:%?310?%;margin:%?20?% auto}.venues-item .img-discount[data-v-456c1e00]{display:block;width:%?30?%;height:%?30?%;margin-left:%?10?%}.venues-item .goods_name[data-v-456c1e00]{display:block;color:#444;font-size:%?28?%;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.venues-item .goods_tag[data-v-456c1e00]{color:#999;font-size:%?20?%;padding:%?2?% %?6?%;border:1px solid #f2f2f2;border-radius:%?6?%}.venues-item .goods_tag uni-image[data-v-456c1e00]{width:10%;height:%?30?%}.venues-item .goods_prom[data-v-456c1e00]{display:block;color:#999;font-size:%?24?%;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.price-now[data-v-456c1e00]{color:#444;font-size:%?24?%;text-align:right;padding-right:%?20?%}.price-now[data-v-456c1e00]:first-letter{font-size:%?20?%}.sentbtn[data-v-456c1e00]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-justify-content:space-around;-ms-flex-pack:distribute;justify-content:space-around;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;margin:%?40?% auto %?20?% auto;width:100%;height:%?200?%}.sentbtn uni-button[data-v-456c1e00]{line-height:%?100?%;width:60%;height:%?100?%;\r\n  /*background: linear-gradient(to bottom, #e34c55 0%,#e30715 100%);*/background:#e34c55;color:#fff;font-size:%?34?%;border-radius:%?20?%;-webkit-box-shadow:0 %?4?% 0 #db1f05;-moz-box-shadow:0 %?4?% 0 #db1f05;box-shadow:0 %?4?% 0 #b31602;margin:%?20?%}.sentbtn uni-text[data-v-456c1e00]{font-size:%?24?%;color:#999}.savebtn[data-v-456c1e00]{font-size:%?28?%;padding-top:%?1?%;height:%?80?%;margin-top:10px}body.?%PAGE?%[data-v-456c1e00]{background:#f2f2f2}",""])},a64e:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"banner",attrs:{"data-bannerlink":t.banner_link},on:{click:function(e){e=t.$handleEvent(e),t.bannerTapTag(e)}}},[a("v-uni-image",{attrs:{src:t.main_title_Bg,"background-size":"cover",mode:"widthFix"}})],1),a("v-uni-view",{staticClass:"wrap"},t._l(t.activityList.goods_list,function(e,i){return a("v-uni-view",{key:i},[a("v-uni-view",{staticClass:"recomment-title",attrs:{"data-bannerlink":e.banner_link},on:{click:function(e){e=t.$handleEvent(e),t.bannerTapTag(e)}}},[a("v-uni-image",{attrs:{src:e.banner_url,mode:"widthFix"}})],1),t._l(e.list,function(e,i){return a("v-uni-view",{key:i,staticClass:"venues-item",attrs:{"data-object-id":e.id,"data-goods-id":e.id,"data-image":e.activity_image?e.activity_image:e.image,hidden:1==e.hidden},on:{click:function(e){e=t.$handleEvent(e),t.showGoods(e)}}},[a("v-uni-image",{staticClass:"mainpic",attrs:{src:e.activity_image?e.activity_image:e.image}}),a("v-uni-image",{staticClass:"img-discount",attrs:{src:e.discount<100?t.img_discount:""}}),a("v-uni-text",{staticClass:"goods_name"},[t._v(t._s(e.name))]),a("v-uni-view",{staticClass:"goods_prom"},[t._v(t._s(e.act_info?e.act_info:"高端大气"))]),a("v-uni-view",{staticClass:"price-now"},[t._v("￥"+t._s(e.sell_price))])],1)})],2)}),1),a("v-uni-view",{staticClass:"footer",attrs:{"data-bannerlink":t.footer_link},on:{click:function(e){e=t.$handleEvent(e),t.bannerTapTag(e)}}},[a("v-uni-image",{attrs:{src:t.main_footer_Bg,mode:"widthFix"}})],1),a("v-uni-view",{staticClass:"sentbtn",attrs:{hidden:t.buttonhidden}},[a("v-uni-button",{on:{click:function(e){e=t.$handleEvent(e),t.qrcodeTapTag(e)}}},[t._v("分享给朋友")]),a("v-uni-button",{on:{click:function(e){e=t.$handleEvent(e),t.goBack(e)}}},[t._v("返回")])],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},aa70:function(t,e,a){"use strict";var i=a("bf900"),n=a.n(i);n.a},bf900:function(t,e,a){var i=a("a634");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("db8a53c2",i,!0,{sourceMap:!1,shadowMode:!1})},fa13:function(t,e,a){"use strict";var i=a("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("a4bb"));a("ac6a"),a("28a5");a("3936");var o=getApp().globalData.weburl,r=getApp().globalData.shop_type,c=getApp().globalData.appid,s=getApp().globalData.secret,l=1,u=wx.getStorageSync("username")?wx.getStorageSync("username"):"",d=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",g=(wx.getStorageSync("openid")&&wx.getStorageSync("openid"),wx.getStorageSync("userInfo")?wx.getStorageSync("userInfo"):""),f=[{id:"activity_banner",title:"感恩节活动",value:"",img:"/uploads/activity_info/activity_banner.gif"},{id:"activity_footer",title:"活动说明",value:"",img:"/uploads/activity_info/activity_footer.png"},{id:"activity_sub1_banner",title:"活动商品列表1",value:"",img:"/uploads/activity_info/activity_1_banner.gif"},{id:"activity_sub2_banner",title:"活动商品列表2",value:"",img:"/uploads/activity_info/activity_2_banner.gif"},{id:"activity_sub3_banner",title:"活动商品列表3",value:"",img:"/uploads/activity_info/activity_3_banner.gif"},{id:"activity_sub4_banner",title:"活动商品列表4",value:"",img:"/uploads/activity_info/activity_4_banner.gif"},{id:"activity_sub5_banner",title:"活动商品列表5",value:"",img:"/uploads/activity_info/activity_5_banner.gif"},{id:"activity_sub6_banner",title:"活动商品列表6",value:"",img:"/uploads/activity_info/activity_6_banner.gif"},{id:"activity_sub7_banner",title:"活动商品列表7",value:"",img:"/uploads/activity_info/activity_7_banner.gif"},{id:"activity_sub8_banner",title:"活动商品列表8",value:"",img:"/uploads/activity_info/activity_8_banner.gif"}],v={data:function(){return{title_name:"送心活动",title_logo:"/images/footer-icon-05.png",img_discount:"/images/discount.png",hidden:!0,scrollTop:0,scrollHeight:0,indicatorDots:!0,vertical:!1,autoplay:!0,interval:3e3,duration:1e3,main_title_Bg:null,banner_link:null,gifts_rcv:0,gifts_snd:0,note:"",username:null,token:null,carts:[],recommentList:[],activityList:[],minusStatuses:[],selectedAllStatus:!0,total:"",startX:0,itemLefts:[],showmorehidden:!0,rshowmorehidden:!0,all_rows:0,rall_rows:0,windowWidth:0,windowHeight:0,cartIds:null,amount:0,nickname:g.nickName,avatarUrl:g.avatarUrl,shop_type:r,navList2:f,buttonhidden:!0,qr_type:"",share_activity_qrcode_cache:"",loadingHidden:!1,act_id:"",act_title:"",main_footer_Bg:"",footer_link:"",page_type:"",order_no:"",coupons:"",receive:"",page:"",userInfo:""}},components:{},props:{},onLoad:function(t){var e=this,a=t.page_type?t.page_type:"",i=t.order_no?t.order_no:"",n=t.act_id?t.act_id:"",o=t.coupons?t.coupons:"",r=t.receive?t.receive:"";e.setData({act_id:n,page_type:a,order_no:i,coupons:o,receive:r}),console.log("activity page_type:",a," order_no:",i," receive:",r," act_id:",n),2==a&&1==r&&wx.navigateTo({url:"../order/receive/receive?order_no="+i+"&receive=1"}),e.get_activity_info()},onShow:function(){var t=this,e=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",a=wx.getStorageSync("username"),i=getCurrentPages();i.length>1&&t.setData({title_logo:"../../images/back.png"}),a||wx.switchTab({url:"../my/index"}),this.setData({username:a}),this.reloadData(a,e)},onShareAppMessage:function(){return{title:"送心礼物",desc:"开启礼物电商时代，200万人都在用的礼物小程序！",path:"/pages/hall/hall?refername="+u}},methods:{goBack:function(){var t=getCurrentPages();t.length>1?wx.navigateBack({changed:!0}):wx.switchTab({url:"../hall/hall"})},image_save:function(t,e){console.log("activity imge save image url:",t,"image_cache_name:",e),wx.downloadFile({url:t,success:function(t){if(200===t.statusCode)t.tempFilePath;else console.log("activity image_save 响应失败",t.statusCode)}})},bannerTapTag:function(t){var e=t.currentTarget.dataset.bannerlink,a=e.split("/");if(console.log("bannerTapTag:",a),"hall"==a[2]||"wish"==a[2]||"index"==a[2]||"my"==a[2]){for(var i=getCurrentPages(),n=i.length,o=0,r=0;r<n;r++)i[r].route.indexOf("hall/hall")>=0&&(o=1,r);1==o?wx.navigateBack({delta:n-r-1}):wx.switchTab({url:"/pages/hall/hall"})}else wx.navigateTo({url:e+"&username="+u+"&token="+d})},qrcodeTapTag:function(t){var e=this,a="activityshare",i=e.act_id,n=e.act_title?e.act_title:"送心活动",o=wx.getStorageSync("activity_qrcode_cache_"+i);e.setData({qr_type:a,share_activity_qrcode_cache:o}),wx.navigateTo({url:"../member/share/share?qr_type="+a+"&act_id="+i+"&act_title="+n+"&share_activity_qrcode_cache="+o})},showGoods:function(t){var e=t.currentTarget.dataset.objectId,a=wx.getStorageSync("username")?wx.getStorageSync("username"):"",i=wx.getStorageSync("token")?wx.getStorageSync("token"):"1",n=t.currentTarget.dataset.goodsId,o=(t.currentTarget.dataset.goodsName,t.currentTarget.dataset.goodsPrice),r=t.currentTarget.dataset.goodsInfo,c=t.currentTarget.dataset.sale,s=t.currentTarget.dataset.image;wx.navigateTo({url:"../details/details?sku_id="+e+"&id="+n+"&goods_info="+r+"&goods_price="+o+"&sale="+c+"&image="+s+"&token="+i+"&username="+a})},touchStart:function(t){var e=t.touches[0].clientX;this.setData({startX:e,itemLefts:[]})},touchMove:function(t){var e=t.currentTarget.dataset.index,a=t.touches[0].clientX,i=this.startX-a,n=this.itemLefts;n[e]=-i,this.setData({itemLefts:n})},touchEnd:function(t){var e=t.currentTarget.dataset.index,a=t.changedTouches[0].clientX,i=this.startX-a,n=60;i=i<=0?0:i>=n?n:i>=n/2?n:0;var o=this.itemLefts;o[e]=-i,this.setData({itemLefts:o})},reloadData:function(t,e){var a=this,i=(a.page,a.pagesize,a.shop_type,a.gifts_rcv,a.gifts_send,wx.getStorageSync("openid")?wx.getStorageSync("openid"):"");console.log("openid:"+i+" username:"+t)},onGotUserInfo:function(t){console.log(t.detail.errMsg),console.log(t.detail.userInfo),console.log(t.detail.rawData)},get_activity_info:function(){var t=this,e=(t.activityList,t.shop_type),a=t.act_id,i="activityshare";t.setData({loadingHidden:!1}),wx.request({url:o+"/api/client/get_activity_info",method:"POST",data:{type:1,shop_type:e,act_id:a},header:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},success:function(n){var r=n.data.result;if(r){t.setData({activityList:r,act_id:r["act_id"],act_title:r["act_title"],main_title_Bg:r["activity_banner_url"],banner_link:r["activity_banner_link"],main_footer_Bg:r["activity_footer_url"],footer_link:r["activity_footer_link"],buttonhidden:!1}),t.setData({loadingHidden:!0}),console.log("get_activity_info:",r,"banner_link",t.banner_link);var l=o+"/api/WXPay/getQRCode?username="+u+"&appid="+c+"&secret="+s+"&shop_type="+e+"&qr_type="+i+"&act_id="+r["act_id"];t.image_save(l,"activity_qrcode_cache_"+a)}}})},bindDownLoad:function(){var t=this;t.setData({page:l++}),console.log("lower")},scroll:function(t){this.setData({scrollTop:t.detail.scrollTop})},topLoad:function(t){this.setData({scrollTop:0}),console.log("lower")},setData:function(t){var e,a,i=this,o=[];(0,n.default)(t).forEach(function(n){o=n.split("."),e=t[n],a=i.$data,o.forEach(function(t,n){n+1==o.length?i.$set(a,t,e):a[t]||i.$set(a,t,{}),a=a[t]})})}}};e.default=v}}]);