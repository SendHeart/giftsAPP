{"version":3,"sources":["webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue?cc1a","webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue?ab6a","webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue?0510","webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue?29d2","webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue","webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue?c216","webpack:///C:/Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue?a3e1"],"names":["data","showCanvas","width","height","index","imageList","tempFileList","isPainting","cache","ctx","windowHeight","windowWidth","ratio","background","components","props","painting","type","Object","value","views","watch","newVal","oldVal","wx","removeStorageSync","getStorageSync","createCanvasContext","JSON","stringify","setData","readyPigment","mode","$emit","errMsg","mounted","methods","console","log","inter","setInterval","clearInterval","clearActions","save","drawRect","top","left","startPainting","getImageList","i","length","push","url","downLoadImages","getImageInfo","then","file","catch","fail","radius","_views","drawData","drawImage","drawText","drawRound","draw","setStorageSync","saveImageToLocal","params","borderRadius","roundedRect","beginPath","arc","Math","PI","fill","clip","r","moveTo","arcTo","restore","MaxLineNumber","breakWord","color","content","fontSize","lineHeight","textAlign","bolder","textDecoration","setTextBaseline","setTextAlign","setFillStyle","setFontSize","text_left","parseInt","measureText","fillText","drawTextLine","fillTop","lineNum","len","match","uni","upx2px","substring","charCodeAt","getContent","detail","row","fillRect","Promise","resolve","reject","objExp","RegExp","objExp2","objExp3","src","complete","res","path","test","canvasToTempFilePath","x","y","canvasId","tempFilePath","obj","that","keys","val","forEach","key","split","$data","key2","$set"],"mappings":"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","file":"common/canvasdrawer/canvasdrawer.js","sourcesContent":["import { render, staticRenderFns } from \"./canvasdrawer.vue?vue&type=template&id=154c36f6&\"\nimport script from \"./canvasdrawer.vue?vue&type=script&lang=js&\"\nexport * from \"./canvasdrawer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./canvasdrawer.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('154c36f6', component.options)\n    } else {\n      api.reload('154c36f6', component.options)\n    }\n    module.hot.accept(\"./canvasdrawer.vue?vue&type=template&id=154c36f6&\", function () {\n      api.rerender('154c36f6', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/qzcsc/Documents/HBuilderProjects/appgift/appsendheart/myappdemo/common/canvasdrawer/canvasdrawer.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-hbuilderx/packages/webpack-uni-nvue-loader/lib/templateLoader.js??vue-loader-options!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./canvasdrawer.vue?vue&type=template&id=154c36f6&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./canvasdrawer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./canvasdrawer.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      showCanvas: false,\r\n      width: 100,\r\n      height: 100,\r\n      index: 0,\r\n      imageList: [],\r\n      tempFileList: [],\r\n      isPainting: false,\r\n      cache: {},\r\n\t  ctx: null,\r\n      windowHeight: \"\",\r\n      windowWidth: \"\",\r\n      ratio: \"\",\r\n      background: \"\"\r\n    };\r\n  },\r\n\r\n  components: {},\r\n  props: {\r\n    painting: {\r\n      type: Object,\r\n      value: {\r\n        views: []\r\n      },\r\n    }\r\n  },\r\n   watch: {\r\n\t\tpainting(newVal, oldVal) {\r\n\t\t\twx.removeStorageSync('canvasdrawer_pic_cache');\r\n\t\t\tthis.cache = wx.getStorageSync('canvasdrawer_pic_cache') || {};\r\n\t\t\tthis.ctx = wx.createCanvasContext('canvasdrawer', this);\r\n           if (!this.isPainting) {\r\n             if (JSON.stringify(newVal) !== JSON.stringify(oldVal)) {\r\n               if (newVal && newVal.width && newVal.height) {\r\n                 this.setData({\r\n                   showCanvas: true,\r\n                   isPainting: true\r\n                 });\r\n                 this.readyPigment();\r\n               }\r\n             } else {\r\n               this.setData({\r\n                 showCanvas: true,\r\n                 isPainting: true\r\n               });\r\n               this.readyPigment();\r\n         \r\n               if (newVal && newVal.mode !== 'same') {\r\n                 this.$emit('getImage', {\r\n                   errMsg: 'canvasdrawer:samme params'\r\n                 });\r\n               }\r\n             }\r\n           }\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\t//wx.removeStorageSync('canvasdrawer_pic_cache');\r\n\t\t//this.cache = wx.getStorageSync('canvasdrawer_pic_cache') || {};\r\n\t\t//this.ctx = wx.createCanvasContext('canvasdrawer', this);\r\n\t},\r\n  methods: {\r\n\t /*\r\n    ready() {\r\n      wx.removeStorageSync('canvasdrawer_pic_cache');\r\n      this.cache = wx.getStorageSync('canvasdrawer_pic_cache') || {};\r\n      this.ctx = wx.createCanvasContext('canvasdrawer', this);\r\n    },\r\n\t*/\r\n\r\n    readyPigment() {\r\n      const {\r\n        width,\r\n        height,\r\n        windowHeight,\r\n        windowWidth,\r\n        background,\r\n        views\r\n      } = this.painting; // 屏幕宽度 375px = 750rpx，1px=2rpx\r\n      // 1px = （750 / 屏幕宽度）rpx；\r\n      // 1rpx = （屏幕宽度 / 750）px;\r\n\r\n      this.setData({\r\n        width,\r\n        height,\r\n        windowHeight,\r\n        windowWidth,\r\n        ratio: 750 / windowWidth,\r\n        background: background\r\n      });\r\n      console.log('canvasdrawer readyPigment background:', background, width, height);\r\n      const inter = setInterval(() => {\r\n        if (this.ctx) {\r\n          clearInterval(inter);\r\n          this.ctx.clearActions();\r\n          this.ctx.save();\r\n          this.drawRect({\r\n            background: background,\r\n            top: 0,\r\n            left: 0,\r\n            width: width,\r\n            height: height\r\n          });\r\n          //this.getImageList(views); //this.downLoadImages(0)\r\n\t\t  this.startPainting();\r\n        }\r\n      }, 200);\r\n    },\r\n\r\n    getImageList(views) {\r\n      const imageList = [];\r\n\r\n      for (let i = 0; i < views.length; i++) {\r\n        if (views[i].type === 'image') {\r\n          imageList.push(views[i].url);\r\n        }\r\n      }\r\n\r\n      this.setData({\r\n        imageList\r\n      });\r\n      this.downLoadImages(0);\r\n    },\r\n\r\n    downLoadImages(index) {\r\n      const {\r\n        imageList,\r\n        tempFileList\r\n      } = this;\r\n\r\n      if (index < imageList.length) {\r\n        //console.log('canvasdrawer downLoadImages:', imageList[index]);\r\n        this.getImageInfo(imageList[index]).then(file => {\r\n          tempFileList.push(file);\r\n          this.setData({\r\n            tempFileList\r\n          });\r\n          this.downLoadImages(index + 1);\r\n\t\t  /*\r\n\t\t  wx.showToast({\r\n\t\t    title: \"canvas 已下载图片\"+this.tempFileList,\r\n\t\t    icon: 'none',\r\n\t\t    duration: 2000\r\n\t\t  });\r\n\t\t  */\r\n\t\t   console.log('canvasdrawer downLoadImages index:',index,' tempFileList:', this.tempFileList);\r\n        }).catch(fail => {\r\n          console.log('canvasdrawer downLoadImages fail:', imageList[index], 'index:', index); //this.downLoadImages(index)\r\n        });\r\n      } else {\r\n        this.startPainting();\r\n      }\r\n    },\r\n\r\n    startPainting: function () {\r\n      const { width, height, views, background, radius = 0 } = this.painting;\r\n      this.width = width;\r\n      this.height = height;\r\n      //const { width, height, views, background, radius = 0 } = this.posterData;\r\n      for (let i = 0; i < views.length; i++) {\r\n      \tconsole.log('canvasdrawer onload views.length:',views.length,' i:',i) ;\r\n          if (views[i].type === 'image') {\r\n              //let _img = views[i].url;\r\n              let _views = views[i];\r\n              let drawData = {};\r\n      \t\t \r\n              drawData = {\r\n                  ..._views,\r\n              };\r\n      \t\tconsole.log('canvasdrawer onload image drawData:',drawData,' i:',i) ;\r\n              this.drawImage(drawData);\r\n      \t\t\r\n          } else if (views[i].type === 'text') {\r\n      \t\t this.drawText(views[i]);\r\n          } else if (views[i].type === 'rect') {\r\n              this.drawRect(views[i]);\r\n          } else if (views[i].type === 'round') {\r\n              this.drawRound(views[i]);\r\n          }\r\n      }\r\n      \r\n     \r\n      this.ctx.draw(false, () => {\r\n        console.log('canvasdrawer this.ctx.draw canvasdrawer_pic_cache:', this.cache);\r\n        wx.removeStorageSync('canvasdrawer_pic_cache');\r\n        wx.setStorageSync('canvasdrawer_pic_cache', this.cache);\r\n        this.saveImageToLocal();\r\n      });\r\n    },\r\n\r\n    drawImage(params) {\r\n      this.ctx.save();\r\n      const {\r\n        url,\r\n        top = 0,\r\n        left = 0,\r\n        width = 0,\r\n        height = 0,\r\n        borderRadius = 0,\r\n        roundedRect = 0\r\n      } = params;\r\n\r\n      if (borderRadius) {\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(left + borderRadius, top + borderRadius, borderRadius, 0, 2 * Math.PI);\r\n        this.ctx.fill();\r\n        this.ctx.clip();\r\n        this.ctx.drawImage(url, left, top, width, height);\r\n        console.log('canvasdrawer drwImge borderRadius:', borderRadius);\r\n      } else if (roundedRect) {\r\n        var r = roundedRect;\r\n        if (width < 2 * r) r = width / 2;\r\n        if (height < 2 * r) r = height / 2;\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(left + r, top);\r\n        this.ctx.arcTo(left + width, top, left + width, top + height, r);\r\n        this.ctx.arcTo(left + width, top + height, left, top + height, r);\r\n        this.ctx.arcTo(left, top + height, left, top, r);\r\n        this.ctx.arcTo(left, top, left + width, top, r); //this.ctx.closePath();\r\n\r\n        this.ctx.fill();\r\n        this.ctx.clip();\r\n        this.ctx.drawImage(url, left, top, width, height);\r\n        console.log('canvasdrawer drwImge roundedRect:', r);\r\n      } else {\r\n        this.ctx.drawImage(url, left, top, width, height);\r\n      }\r\n      this.ctx.restore();\r\n    },\r\n\r\n    drawText(params) {\r\n      this.ctx.save();\r\n      const {\r\n        MaxLineNumber = 2,\r\n        breakWord = false,\r\n        color = 'black',\r\n        content = '',\r\n        fontSize = 16,\r\n        top = 0,\r\n        left = 0,\r\n        lineHeight = 20,\r\n        textAlign = 'left',\r\n        width,\r\n        bolder = false,\r\n        textDecoration = 'none'\r\n      } = params;\r\n      this.ctx.beginPath();\r\n      this.ctx.setTextBaseline('top');\r\n      this.ctx.setTextAlign(textAlign);\r\n      this.ctx.setFillStyle(color);\r\n      this.ctx.setFontSize(fontSize * 1.2); //this.ctx.setFontSize(content.font)\r\n\r\n      if (!breakWord) {\r\n        if (textAlign == 'center') {\r\n          let text_left = parseInt((left + width - this.ctx.measureText(content).width) / 2);\r\n          this.ctx.fillText(content, text_left, top);\r\n          this.drawTextLine(text_left, top, textDecoration, color, fontSize, content);\r\n        } else if (textAlign == 'right') {\r\n          let text_left = parseInt(left + width - this.ctx.measureText(content).width);\r\n          this.ctx.fillText(content, text_left, top);\r\n          this.drawTextLine(text_left, top, textDecoration, color, fontSize, content);\r\n          console.log('drawText() !breakWord content:', content, 'Width:', this.width, ' width:', width, ' content len:', this.ctx.measureText(content).width, 'textAlign:', textAlign, 'text_left:', text_left, ' left', left, 'textDecoration:', textDecoration);\r\n        } else {\r\n          this.ctx.fillText(content, left, top);\r\n          this.drawTextLine(left, top, textDecoration, color, fontSize, content);\r\n        } //console.log('drawText() !breakWord content:', content, 'windowWidth:', this.data.width, 'content len:', this.ctx.measureText(content).width, 'textAlign:', textAlign, 'text_left:', left, 'textDecoration:', textDecoration)\r\n\r\n      } else {\r\n        let fillText = '';\r\n        let fillTop = top;\r\n        let lineNum = 1; //console.log('drawText() breakWord content:', content, content.length, this.ctx.measureText(fillText).width,width)\r\n\t\tlet len = 0; \r\n        for (let i = 0; i < content.length; i++) {\r\n          fillText += [content[i]];\r\n\t\t  len += content[i].match(/[^\\x00-\\xff]/ig)?2:1   //计算汉字和字母的宽度\r\n          if (this.ctx.measureText(fillText).width > width || (len+3)*uni.upx2px(fontSize) > width) {\r\n            if (lineNum === MaxLineNumber) {\r\n              if (i !== content.length) {\r\n                fillText = fillText.substring(0, fillText.length - 1) + '...';\r\n                this.ctx.fillText(fillText, left, fillTop);\r\n                this.drawTextLine(left, fillTop, textDecoration, color, fontSize, fillText);\r\n                fillText = '';\r\n\t\t\t\tlen = 0 ;\r\n                break;\r\n              }\r\n            }\r\n\r\n            this.ctx.fillText(fillText, left, fillTop);\r\n            this.drawTextLine(left, fillTop, textDecoration, color, fontSize, fillText);\r\n            fillText = '';\r\n            fillTop += lineHeight;\r\n            lineNum++;\r\n\t\t\t\r\n          } else if (content.charCodeAt(i) == 10) {\r\n            this.ctx.fillText(fillText, left, fillTop);\r\n            this.drawTextLine(left, fillTop, textDecoration, color, fontSize, fillText);\r\n            fillText = '';\r\n            fillTop += lineHeight;\r\n            lineNum++;\r\n          }\r\n        }\r\n\r\n        this.ctx.fillText(fillText, left, fillTop);\r\n        this.drawTextLine(left, fillTop, textDecoration, color, fontSize, fillText);\r\n      }\r\n\r\n      this.ctx.restore();\r\n\r\n      if (bolder) {\r\n        this.drawText({ ...params,\r\n          left: left + 0.3,\r\n          top: top + 0.3,\r\n          bolder: false,\r\n          textDecoration: 'none'\r\n        });\r\n      }\r\n    },\r\n\r\n    getContent(detail, length = 24, row = 2) {\r\n      let len = 0;\r\n      let index = 0;\r\n      let content = [];\r\n\r\n      for (let i = 0; len < detail.length; i++) {\r\n        // 若未定义则致为 ''\r\n        if (!content[index]) content[index] = '';\r\n        content[index] += detail[i]; // 中文或者数字占两个长度\r\n\r\n        if (detail.charCodeAt(i) > 127 || detail.charCodeAt(i) >= 48 && detail.charCodeAt(i) <= 57) {\r\n          len += 2;\r\n        } else {\r\n          len++;\r\n        }\r\n\r\n        if (len >= length || row - index == 1 && len >= length - 2) {\r\n          len = 0;\r\n          index++;\r\n        }\r\n\r\n        if (index === row) break;\r\n      }\r\n\r\n      return content;\r\n    },\r\n\r\n    drawTextLine(left, top, textDecoration, color, fontSize, content) {\r\n      if (textDecoration === 'underline') {\r\n        this.drawRect({\r\n          background: color,\r\n          top: top + fontSize * 1.2,\r\n          left: left - 1,\r\n          width: this.ctx.measureText(content).width + 3,\r\n          height: 1\r\n        });\r\n      } else if (textDecoration === 'line-through') {\r\n        this.drawRect({\r\n          background: color,\r\n          top: top + fontSize * 0.6,\r\n          left: left - 1,\r\n          width: this.ctx.measureText(content).width + 3,\r\n          height: 1\r\n        });\r\n      }\r\n    },\r\n\r\n    drawRect(params) {\r\n      this.ctx.save();\r\n      const {\r\n        background,\r\n        top = 0,\r\n        left = 0,\r\n        width = 0,\r\n        height = 0\r\n      } = params;\r\n      this.ctx.setFillStyle(background);\r\n      this.ctx.fillRect(left, top, width, height);\r\n      this.ctx.restore();\r\n    },\r\n\r\n    getImageInfo(url) {\r\n      return new Promise((resolve, reject) => {\r\n        if (this.cache[url]) {\r\n          console.log(' canvasdrawer getImageInfo() cache[url]:', this.cache[url], 'url:', url);\r\n          resolve(this.cache[url]);\r\n        } else {\r\n          const objExp = new RegExp(/^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- .\\/?%&=]*)?/);\r\n          const objExp2 = new RegExp(/^http:\\/\\/store\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- .\\/?%&=]*)?/);\r\n          const objExp3 = new RegExp(/^wxfile:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- .\\/?%&=]*)?/);\r\n         \r\n\t\t  uni.getImageInfo({\r\n            src: url,\r\n            complete: res => {\r\n              if (res.errMsg === 'getImageInfo:ok') {\r\n                this.cache[url] = res.path;\r\n\t\t\t\t/*\r\n\t\t\t\twx.showToast({\r\n\t\t\t\t  title: \"canvas 图片下载完成\"+res.path,\r\n\t\t\t\t  icon: 'none',\r\n\t\t\t\t  duration: 2000\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n                resolve(res.path);\r\n              } else {\r\n                console.log('getImageInfo complete error url:', url, 'res:', res); //console.log('res:', res)\r\n                this.$emit('getImage', {\r\n                  errMsg: 'canvasdrawer:download fail'\r\n                }); //reject(new Error(' canvasdrawer getImageInfo fail'))\r\n              }\r\n            },\r\n            fail: res => {\r\n\t\t\t\tconsole.log(' canvasdrawer wx.getImageInfo 接口调用失败', res, url); //reject(new Error('canvasdrawer wx.getImageInfo 接口调用失败'))\r\n\t\t\t\tthis.$emit('getImage', {\r\n\t\t\t\t\terrMsg: 'canvasdrawer:getImageInfo 接口调用失败'\r\n\t\t\t\t});\r\n\t\t\t}\r\n          });\r\n\r\n          if (objExp.test(url) || objExp2.test(url) || objExp3.test(url)) {} else {\r\n            console.log('canvasdrawer getImageInfo cache url already:', url); //this.cache[url] = url\r\n            //resolve(url)\r\n          }\r\n        }\r\n      });\r\n    },\r\n\r\n    saveImageToLocal() {\r\n      const {\r\n        width,\r\n        height\r\n      } = this;\r\n      wx.canvasToTempFilePath({\r\n        x: 0,\r\n        y: 0,\r\n        width,\r\n        height,\r\n        canvasId: 'canvasdrawer',\r\n        complete: res => {\r\n          if (res.errMsg === 'canvasToTempFilePath:ok') {\r\n            this.setData({\r\n              showCanvas: false,\r\n              isPainting: false,\r\n              imageList: [],\r\n              tempFileList: []\r\n            });\r\n\t\t\t/*\r\n\t\t\twx.showToast({\r\n\t\t\t  title: \"canvasdrawer 图片保留本地\",\r\n\t\t\t  icon: 'none',\r\n\t\t\t  duration: 2000\r\n\t\t\t});\r\n\t\t\t*/\r\n            this.$emit('getImage', {\r\n              tempFilePath: res.tempFilePath,\r\n              errMsg: 'canvasdrawer:ok'\r\n            });\r\n          } else {\r\n            this.$emit('getImage', {\r\n              errMsg: 'canvasdrawer:fail'\r\n            });\r\n          }\r\n        }\r\n      }, this);\r\n    },\r\n\r\n    setData: function (obj) {\r\n      let that = this;\r\n      let keys = [];\r\n      let val, data;\r\n      Object.keys(obj).forEach(function (key) {\r\n        keys = key.split('.');\r\n        val = obj[key];\r\n        data = that.$data;\r\n        keys.forEach(function (key2, index) {\r\n          if (index + 1 == keys.length) {\r\n            that.$set(data, key2, val);\r\n          } else {\r\n            if (!data[key2]) {\r\n              that.$set(data, key2, {});\r\n            }\r\n          }\r\n\r\n          data = data[key2];\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n","import mod from \"-!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./canvasdrawer.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./canvasdrawer.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}